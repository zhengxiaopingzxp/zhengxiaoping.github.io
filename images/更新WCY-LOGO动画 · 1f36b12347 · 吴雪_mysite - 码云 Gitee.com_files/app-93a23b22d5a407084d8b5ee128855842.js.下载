/*
Chosen source: generate output using 'cake build'
Copyright (c) 2011 by Harvest
*/
(function(){var e,t;t=this,e=function(){function e(t,i){this.form_field=t,this.options=null!=i?i:{},e.browser_is_supported()&&(this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup())}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:!0,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0,this.inherit_select_classes=this.options.inherit_select_classes||!1},e.prototype.set_default_text=function(){return this.default_text=this.form_field.getAttribute("data-placeholder")?this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},e.prototype.input_blur=function(){var e=this;return this.mouse_on_container?void 0:(this.active_field=!1,setTimeout(function(){return e.blur_test()},100))},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),e.group_array_index!=null&&t.push("group-option"),e.classes!==""&&t.push(e.classes),i=e.style.cssText!==""?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.choices_click=function(e){return e.preventDefault(),this.results_showing?void 0:this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=(i=e.which)!=null?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t,i;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",i=Math.floor(Math.random()*e.length),t=e.substring(i,i+1)},e.prototype.container_width=function(){var e;return this.options.width!=null?this.options.width:(e=window.getComputedStyle!=null?parseFloat(window.getComputedStyle(this.form_field).getPropertyValue("width")):"undefined"!=typeof jQuery&&null!==jQuery&&this.form_field_jq!=null?this.form_field_jq.outerWidth():this.form_field.getWidth(),e+"px")},e.browser_is_supported=function(){var e;return window.navigator.appName==="Microsoft Internet Explorer"?null!==(e=document.documentMode)&&e>=8:!0},e.default_multiple_text="Select Some Options",e.default_single_text="Select an Option",e.default_no_result_text="No results match",e}(),t.AbstractChosen=e}).call(this),function(){var e;e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return e.nodeName.toUpperCase()==="OPTGROUP"?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,s,n,o,a;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),o=e.childNodes,a=[],s=0,n=o.length;n>s;s++)i=o[s],a.push(this.add_option(i,t,e.disabled));return a},e.prototype.add_option=function(e,t,i){return e.nodeName.toUpperCase()==="OPTION"?(e.text!==""?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:i===!0?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1):void 0},e}(),e.select_to_array=function(t){var i,s,n,o,a;for(s=new e,a=t.childNodes,n=0,o=a.length;o>n;n++)i=a[n],s.add_node(i);return s.parsed},this.SelectParser=e}.call(this),/*
Chosen source: generate output using 'cake build'
Copyright (c) 2011 by Harvest
*/
function(){var e,t,i,s,n={}.hasOwnProperty,o=function(e,t){function i(){this.constructor=e}for(var s in t)n.call(t,s)&&(e[s]=t[s]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};i=this,e=jQuery,e.fn.extend({chosen:function(i){return AbstractChosen.browser_is_supported()?this.each(function(){var s;return s=e(this),s.hasClass("chzn-done")?void 0:s.data("chosen",new t(this,i))}):this}}),t=function(t){function n(){return s=n.__super__.constructor.apply(this,arguments)}return o(n,t),n.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},n.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},n.prototype.set_up_html=function(){var t,i;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",t=["chzn-container"],t.push("chzn-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chzn-rtl"),i={id:this.container_id,"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.container=e("<div />",i),this.is_multiple?this.container.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop"><ul class="chzn-results"></ul></div>'):this.container.html('<a href="javascript:void(0)" class="chzn-single chzn-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chzn-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first()),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},n.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){e.container_mousedown(t)}),this.container.mouseup(function(t){e.container_mouseup(t)}),this.container.mouseenter(function(t){e.mouse_enter(t)}),this.container.mouseleave(function(t){e.mouse_leave(t)}),this.search_results.mouseup(function(t){e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel DOMMouseScroll",function(t){e.search_results_mousewheel(t)}),this.form_field_jq.bind("liszt:updated",function(t){e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){e.container_mousedown(t)}),this.search_field.blur(function(t){e.input_blur(t)}),this.search_field.keyup(function(t){e.keyup_checker(t)}),this.search_field.keydown(function(t){e.keydown_checker(t)}),this.search_field.focus(function(t){e.input_focus(t)}),this.is_multiple?this.search_choices.click(function(t){e.choices_click(t)}):this.container.click(function(e){e.preventDefault()})},n.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},n.prototype.container_mousedown=function(t){return this.is_disabled||(t&&t.type==="mousedown"&&!this.results_showing&&t.preventDefault(),null!=t&&e(t.target).hasClass("search-choice-close"))?void 0:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field())},n.prototype.container_mouseup=function(e){return e.target.nodeName!=="ABBR"||this.is_disabled?void 0:this.results_reset(e)},n.prototype.search_results_mousewheel=function(e){var t,i,s;return t=-((i=e.originalEvent)!=null?i.wheelDelta:void 0)||((s=e.originialEvent)!=null?s.detail:void 0),null!=t?(e.preventDefault(),e.type==="DOMMouseScroll"&&(t=40*t),this.search_results.scrollTop(t+this.search_results.scrollTop())):void 0},n.prototype.blur_test=function(){return!this.active_field&&this.container.hasClass("chzn-container-active")?this.close_field():void 0},n.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},n.prototype.activate_field=function(){return this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},n.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},n.prototype.results_build=function(){var e,t,s,n,o;for(this.parsing=!0,this.results_data=i.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",o=this.results_data,s=0,n=o.length;n>s;s++)t=o[s],t.group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},n.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},n.prototype.result_do_highlight=function(e){var t,i,s,n,o;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),s=parseInt(this.search_results.css("maxHeight"),10),o=this.search_results.scrollTop(),n=s+o,i=this.result_highlight.position().top+this.search_results.scrollTop(),t=i+this.result_highlight.outerHeight(),t>=n)return this.search_results.scrollTop(t-s>0?t-s:0);if(o>i)return this.search_results.scrollTop(i)}},n.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},n.prototype.results_show=function(){if(this.result_single_selected!=null)this.result_do_highlight(this.result_single_selected);else if(this.is_multiple&&this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1;return this.container.addClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},n.prototype.results_hide=function(){return this.result_clear_highlight(),this.container.removeClass("chzn-with-drop"),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.results_showing=!1},n.prototype.set_tab_index=function(){var e;return this.form_field_jq.attr("tabindex")?(e=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.search_field.attr("tabindex",e)):void 0},n.prototype.set_label_behavior=function(){var t=this;return this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for="+this.form_field.id+"]")),this.form_field_label.length>0?this.form_field_label.click(function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()}):void 0},n.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},n.prototype.search_results_mouseup=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i.length?(this.result_highlight=i,this.result_select(t),this.search_field.focus()):void 0},n.prototype.search_results_mouseover=function(t){var i;return i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first(),i?this.result_do_highlight(i):void 0},n.prototype.search_results_mouseout=function(t){return e(t.target).hasClass("active-result")?this.result_clear_highlight():void 0},n.prototype.choice_build=function(t){var i,s,n,o=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+t.array_index,this.choices+=1,s=t.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+t.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>',this.search_container.before(s),n=e("#"+i).find("a").first(),n.click(function(e){return o.choice_destroy_link_click(e)}))},n.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),t.stopPropagation(),this.is_disabled?void 0:this.choice_destroy(e(t.target))},n.prototype.choice_destroy=function(e){return this.result_deselect(e.attr("rel"))?(this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove(),this.search_field_scale()):void 0},n.prototype.results_reset=function(){return this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field?this.results_hide():void 0},n.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},n.prototype.result_select=function(e){var t,i,s,n;return this.result_highlight?(t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),n=i.substr(i.lastIndexOf("_")+1),s=this.results_data[n],s.selected=!0,this.form_field.options[s.options_index].selected=!0,this.is_multiple?this.choice_build(s):(this.selected_item.find("span").first().text(s.text),this.allow_single_deselect&&this.single_deselect_control_build()),(e.metaKey||e.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[s.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale()):void 0},n.prototype.result_activate=function(e){return e.addClass("active-result")},n.prototype.result_deactivate=function(e){return e.removeClass("active-result")},n.prototype.result_deselect=function(t){var i,s;return s=this.results_data[t],this.form_field.options[s.options_index].disabled?!1:(s.selected=!1,this.form_field.options[s.options_index].selected=!1,i=e("#"+this.container_id+"_o_"+t),i.removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[s.options_index].value}),this.search_field_scale(),!0)},n.prototype.single_deselect_control_build=function(){return this.allow_single_deselect&&this.selected_item.find("abbr").length<1?this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'):void 0},n.prototype.winnow_results=function(){var t,i,s,n,o,a,r,l,c,d,h,u,p,f,m,g,v,b;for(this.no_results_clear(),c=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),a=this.search_contains?"":"^",o=new RegExp(a+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),p=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),b=this.results_data,f=0,g=b.length;g>f;f++)if(i=b[f],!i.disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,l=i.dom_id,r=e("#"+l),o.test(i.html))t=!0,c+=1;else if(this.enable_split_word_search&&(i.html.indexOf(" ")>=0||i.html.indexOf("[")===0)&&(n=i.html.replace(/\[|\]/g,"").split(" "),n.length))for(m=0,v=n.length;v>m;m++)s=n[m],o.test(s)&&(t=!0,c+=1);t?(d.length?(h=i.html.search(p),u=i.html.substr(0,h+d.length)+"</em>"+i.html.substr(h+d.length),u=u.substr(0,h)+"<em>"+u.substr(h)):u=i.html,r.html(u),this.result_activate(r),i.group_array_index!=null&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(r))}return 1>c&&d.length?this.no_results(d):this.winnow_results_set_highlight()},n.prototype.winnow_results_clear=function(){var t,i,s,n,o;for(this.search_field.val(""),i=this.search_results.find("li"),o=[],s=0,n=i.length;n>s;s++)t=i[s],t=e(t),t.hasClass("group-result")?o.push(t.css("display","auto")):this.is_multiple&&t.hasClass("result-selected")?o.push(void 0):o.push(this.result_activate(t));return o},n.prototype.winnow_results_set_highlight=function(){var e,t;return this.result_highlight||(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),e=t.length?t.first():this.search_results.find(".active-result").first(),null==e)?void 0:this.result_do_highlight(e)},n.prototype.no_results=function(t){var i;return i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>'),i.find("span").first().html(t),this.search_results.append(i)},n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},n.prototype.keydown_arrow=function(){var t,i;return this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first(),i&&this.result_do_highlight(i)):(t=this.search_results.find("li.active-result").first(),t&&this.result_do_highlight(e(t))),this.results_showing?void 0:this.results_show()},n.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},n.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last(),e.length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0)},n.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},n.prototype.keydown_checker=function(e){var t,i;switch(t=(i=e.which)!=null?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},n.prototype.search_field_scale=function(){var t,i,s,n,o,a,r,l;if(this.is_multiple){for(i=0,a=0,n="position:absolute; left: -1000px; top: -1000px; display:none;",o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"],r=0,l=o.length;l>r;r++)s=o[r],n+=s+":"+this.search_field.css(s)+";";return t=e("<div />",{style:n}),t.text(this.search_field.val()),e("body").append(t),a=t.width()+25,t.remove(),this.f_width||(this.f_width=this.container.outerWidth()),a>this.f_width-10&&(a=this.f_width-10),this.search_field.css({width:a+"px"})}},n.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},n}(AbstractChosen),i.Chosen=t}.call(this),/*
Copyright 2012 Igor Vaynberg

Version: 3.3.2 Timestamp: Mon Mar 25 12:14:18 PDT 2013

This software is licensed under the Apache License, Version 2.0 (the "Apache License") or the GNU
General Public License version 2 (the "GPL License"). You may choose either license to govern your
use of this software only upon the condition that you accept all of the terms of either the Apache
License or the GPL License.

You may obtain a copy of the Apache License and the GPL License at:

    http://www.apache.org/licenses/LICENSE-2.0
    http://www.gnu.org/licenses/gpl-2.0.html

Unless required by applicable law or agreed to in writing, software distributed under the
Apache License or the GPL Licesnse is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR
CONDITIONS OF ANY KIND, either express or implied. See the Apache License and the GPL License for
the specific language governing permissions and limitations under the Apache License and the GPL License.
*/
function(e){typeof e.fn.each2=="undefined"&&e.fn.extend({each2:function(t){for(var i=e([0]),s=-1,n=this.length;++s<n&&(i.context=i[0]=this[s])&&t.call(i[0],s,i)!==!1;);return this}})}(jQuery),function(e,t){"use strict";function i(e,t){for(var i=0,n=t.length;n>i;i+=1)if(s(e,t[i]))return i;return-1}function s(e,i){return e===i?!0:e===t||i===t?!1:null===e||null===i?!1:e.constructor===String?e+""==i+"":i.constructor===String?i+""==e+"":!1}function n(t,i){var s,n,o;if(null===t||t.length<1)return[];for(s=t.split(i),n=0,o=s.length;o>n;n+=1)s[n]=e.trim(s[n]);return s}function o(e){return e.outerWidth(!1)-e.width()}function a(i){var s="keyup-change-value";i.bind("keydown",function(){e.data(i,s)===t&&e.data(i,s,i.val())}),i.bind("keyup",function(){var n=e.data(i,s);n!==t&&i.val()!==n&&(e.removeData(i,s),i.trigger("keyup-change"))})}function r(i){i.bind("mousemove",function(i){var s=F;(s===t||s.x!==i.pageX||s.y!==i.pageY)&&e(i.target).trigger("mousemove-filtered",i)})}function l(e,i,s){s=s||t;var n;return function(){var t=arguments;window.clearTimeout(n),n=window.setTimeout(function(){i.apply(s,t)},e)}}function c(e){var t,i=!1;return function(){return i===!1&&(t=e(),i=!0),t}}function d(e,t){var s=l(e,function(e){t.trigger("scroll-debounced",e)});t.bind("scroll",function(e){i(e.target,t.get())>=0&&s(e)})}function h(e){e[0]!==document.activeElement&&window.setTimeout(function(){var t,i=e[0],s=e.val().length;e.focus(),e.is(":visible")&&i===document.activeElement&&(i.setSelectionRange?i.setSelectionRange(s,s):i.createTextRange&&(t=i.createTextRange(),t.collapse(!1),t.select()))},0)}function u(e){e.preventDefault(),e.stopPropagation()}function p(e){e.preventDefault(),e.stopImmediatePropagation()}function f(t){if(!j){var i=t[0].currentStyle||window.getComputedStyle(t[0],null);j=e(document.createElement("div")).css({position:"absolute",left:"-10000px",top:"-10000px",display:"none",fontSize:i.fontSize,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,letterSpacing:i.letterSpacing,textTransform:i.textTransform,whiteSpace:"nowrap"}),j.attr("class","select2-sizer"),e("body").append(j)}return j.text(t.val()),j.width()}function m(t,i,s){var n,o,a=[];n=t.attr("class"),n&&(n=""+n,e(n.split(" ")).each2(function(){this.indexOf("select2-")===0&&a.push(this)})),n=i.attr("class"),n&&(n=""+n,e(n.split(" ")).each2(function(){this.indexOf("select2-")!==0&&(o=s(this),o&&a.push(this))})),t.attr("class",a.join(" "))}function g(e,t,i,s){var n=e.toUpperCase().indexOf(t.toUpperCase()),o=t.length;return 0>n?(i.push(s(e)),void 0):(i.push(s(e.substring(0,n))),i.push("<span class='select2-match'>"),i.push(s(e.substring(n,n+o))),i.push("</span>"),i.push(s(e.substring(n+o,e.length))),void 0)}function v(t){var i,s=0,n=null,o=t.quietMillis||100,a=t.url,r=this;return function(l){window.clearTimeout(i),i=window.setTimeout(function(){s+=1;var i=s,o=t.data,c=a,d=t.transport||e.ajax,h=t.type||"GET",u={};o=o?o.call(r,l.term,l.page,l.context):null,c="function"==typeof c?c.call(r,l.term,l.page,l.context):c,null!==n&&n.abort(),t.params&&(e.isFunction(t.params)?e.extend(u,t.params.call(r)):e.extend(u,t.params)),e.extend(u,{url:c,dataType:t.dataType,data:o,type:h,cache:!1,success:function(e){if(!(s>i)){var n=t.results(e,l.page);l.callback(n)}}}),n=d.call(r,u)},o)}}function b(t){var i,s,n=t,o=function(e){return""+e.text};e.isArray(n)&&(s=n,n={results:s}),e.isFunction(n)===!1&&(s=n,n=function(){return s});var a=n();return a.text&&(o=a.text,e.isFunction(o)||(i=n.text,o=function(e){return e[i]})),function(t){var i,s=t.term,a={results:[]};return""===s?(t.callback(n()),void 0):(i=function(n,a){var r,l;if(n=n[0],n.children){r={};for(l in n)n.hasOwnProperty(l)&&(r[l]=n[l]);r.children=[],e(n.children).each2(function(e,t){i(t,r.children)}),(r.children.length||t.matcher(s,o(r),n))&&a.push(r)}else t.matcher(s,o(n),n)&&a.push(n)},e(n().results).each2(function(e,t){i(t,a.results)}),t.callback(a),void 0)}}function _(i){var s=e.isFunction(i);return function(n){var o=n.term,a={results:[]};e(s?i():i).each(function(){var e=this.text!==t,i=e?this.text:this;(""===o||n.matcher(o,i))&&a.results.push(e?this:{id:this,text:this})}),n.callback(a)}}function y(t){if(e.isFunction(t))return!0;if(!t)return!1;throw new Error("formatterName must be a function or a falsy value")}function w(t){return e.isFunction(t)?t():t}function C(t){var i=0;return e.each(t,function(e,t){t.children?i+=C(t.children):i++}),i}function k(e,i,n,o){var a,r,l,c,d,h=e,u=!1;if(!o.createSearchChoice||!o.tokenSeparators||o.tokenSeparators.length<1)return t;for(;;){for(r=-1,l=0,c=o.tokenSeparators.length;c>l&&(d=o.tokenSeparators[l],r=e.indexOf(d),!(r>=0));l++);if(0>r)break;if(a=e.substring(0,r),e=e.substring(r+d.length),a.length>0&&(a=o.createSearchChoice(a,i),a!==t&&null!==a&&o.id(a)!==t&&o.id(a)!==null)){for(u=!1,l=0,c=i.length;c>l;l++)if(s(o.id(a),o.id(i[l]))){u=!0;break}u||n(a)}}return h!==e?e:void 0}function x(t,i){var s=function(){};return s.prototype=new t,s.prototype.constructor=s,s.prototype.parent=t.prototype,s.prototype=e.extend(s.prototype,i),s}if(window.Select2===t){var D,T,S,$,M,j,F,U;D={TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46,isArrow:function(e){switch(e=e.which?e.which:e){case D.LEFT:case D.RIGHT:case D.UP:case D.DOWN:return!0}return!1},isControl:function(e){var t=e.which;switch(t){case D.SHIFT:case D.CTRL:case D.ALT:return!0}return e.metaKey?!0:!1},isFunctionKey:function(e){return e=e.which?e.which:e,e>=112&&123>=e}},U=e(document),M=function(){var e=1;return function(){return e++}}(),U.bind("mousemove",function(e){F={x:e.pageX,y:e.pageY}}),T=x(Object,{bind:function(e){var t=this;return function(){e.apply(t,arguments)}},init:function(i){var s,n,o=".select2-results";this.opts=i=this.prepareOpts(i),this.id=i.id,i.element.data("select2")!==t&&i.element.data("select2")!==null&&this.destroy(),this.enabled=!0,this.container=this.createContainer(),this.containerId="s2id_"+(i.element.attr("id")||"autogen"+M()),this.containerSelector="#"+this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g,"\\$1"),this.container.attr("id",this.containerId),this.body=c(function(){return i.element.closest("body")}),m(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.css(w(i.containerCss)),this.container.addClass(w(i.containerCssClass)),this.elementTabIndex=this.opts.element.attr("tabIndex"),this.opts.element.data("select2",this).addClass("select2-offscreen").bind("focus.select2",function(){e(this).select2("focus")}).attr("tabIndex","-1").before(this.container),this.container.data("select2",this),this.dropdown=this.container.find(".select2-drop"),this.dropdown.addClass(w(i.dropdownCssClass)),this.dropdown.data("select2",this),this.results=s=this.container.find(o),this.search=n=this.container.find("input.select2-input"),n.attr("tabIndex",this.elementTabIndex),this.resultsPage=0,this.context=null,this.initContainer(),r(this.results),this.dropdown.delegate(o,"mousemove-filtered touchstart touchmove touchend",this.bind(this.highlightUnderEvent)),d(80,this.results),this.dropdown.delegate(o,"scroll-debounced",this.bind(this.loadMoreIfNeeded)),e.fn.mousewheel&&s.mousewheel(function(e,t,i,n){var o=s.scrollTop();n>0&&0>=o-n?(s.scrollTop(0),u(e)):0>n&&s.get(0).scrollHeight-s.scrollTop()+n<=s.height()&&(s.scrollTop(s.get(0).scrollHeight-s.height()),u(e))}),a(n),n.bind("keyup-change input paste",this.bind(this.updateResults)),n.bind("focus",function(){n.addClass("select2-focused")}),n.bind("blur",function(){n.removeClass("select2-focused")}),this.dropdown.delegate(o,"mouseup",this.bind(function(t){e(t.target).closest(".select2-result-selectable").length>0&&(this.highlightUnderEvent(t),this.selectHighlighted(t))})),this.dropdown.bind("click mouseup mousedown",function(e){e.stopPropagation()}),e.isFunction(this.opts.initSelection)&&(this.initSelection(),this.monitorSource()),(i.element.is(":disabled")||i.element.is("[readonly='readonly']"))&&this.disable()},destroy:function(){var e=this.opts.element.data("select2");this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),e!==t&&(e.container.remove(),e.dropdown.remove(),e.opts.element.removeClass("select2-offscreen").removeData("select2").unbind(".select2").attr({tabIndex:this.elementTabIndex}).show())},prepareOpts:function(i){var o,a,r,l;if(o=i.element,o.get(0).tagName.toLowerCase()==="select"&&(this.select=a=i.element),a&&e.each(["id","multiple","ajax","query","createSearchChoice","initSelection","data","tags"],function(){if(this in i)throw new Error("Option '"+this+"' is not allowed for Select2 when attached to a <select> element.")}),i=e.extend({},{populateResults:function(s,n,o){var a,r=this.opts.id,l=this;a=function(s,n,c){var d,h,u,p,f,m,g,v,b,_;for(s=i.sortResults(s,n,o),d=0,h=s.length;h>d;d+=1)u=s[d],f=u.disabled===!0,p=!f&&r(u)!==t,m=u.children&&u.children.length>0,g=e("<li></li>"),g.addClass("select2-results-dept-"+c),g.addClass("select2-result"),g.addClass(p?"select2-result-selectable":"select2-result-unselectable"),f&&g.addClass("select2-disabled"),m&&g.addClass("select2-result-with-children"),g.addClass(l.opts.formatResultCssClass(u)),v=e(document.createElement("div")),v.addClass("select2-result-label"),_=i.formatResult(u,v,o,l.opts.escapeMarkup),_!==t&&v.html(_),g.append(v),m&&(b=e("<ul></ul>"),b.addClass("select2-result-sub"),a(u.children,b,c+1),g.append(b)),g.data("select2-data",u),n.append(g)},a(n,s,0)}},e.fn.select2.defaults,i),typeof i.id!="function"&&(r=i.id,i.id=function(e){return e[r]}),e.isArray(i.element.data("select2Tags"))){if("tags"in i)throw"tags specified as both an attribute 'data-select2-tags' and in options of Select2 "+i.element.attr("id");i.tags=i.element.data("select2Tags")}if(a?(i.query=this.bind(function(i){var n,a,r,l={results:[],more:!1},c=i.term;r=function(e,t){var n;e.is("option")?i.matcher(c,e.text(),e)&&t.push({id:e.attr("value"),text:e.text(),element:e.get(),css:e.attr("class"),disabled:s(e.attr("disabled"),"disabled")}):e.is("optgroup")&&(n={text:e.attr("label"),children:[],element:e.get(),css:e.attr("class")},e.children().each2(function(e,t){r(t,n.children)}),n.children.length>0&&t.push(n))},n=o.children(),this.getPlaceholder()!==t&&n.length>0&&(a=n[0],e(a).text()===""&&(n=n.not(a))),n.each2(function(e,t){r(t,l.results)}),i.callback(l)}),i.id=function(e){return e.id},i.formatResultCssClass=function(e){return e.css}):"query"in i||("ajax"in i?(l=i.element.data("ajax-url"),l&&l.length>0&&(i.ajax.url=l),i.query=v.call(i.element,i.ajax)):"data"in i?i.query=b(i.data):"tags"in i&&(i.query=_(i.tags),i.createSearchChoice===t&&(i.createSearchChoice=function(e){return{id:e,text:e}}),i.initSelection===t&&(i.initSelection=function(t,o){var a=[];e(n(t.val(),i.separator)).each(function(){var t=this,n=this,o=i.tags;e.isFunction(o)&&(o=o()),e(o).each(function(){return s(this.id,t)?(n=this.text,!1):void 0}),a.push({id:t,text:n})}),o(a)}))),typeof i.query!="function")throw"query function not defined for Select2 "+i.element.attr("id");return i},monitorSource:function(){var e,t=this.opts.element;t.bind("change.select2",this.bind(function(){this.opts.element.data("select2-change-triggered")!==!0&&this.initSelection()})),e=this.bind(function(){var e,t;e=this.opts.element.attr("disabled")!=="disabled",t=this.opts.element.attr("readonly")==="readonly",e=e&&!t,this.enabled!==e&&(e?this.enable():this.disable()),m(this.container,this.opts.element,this.opts.adaptContainerCssClass),this.container.addClass(w(this.opts.containerCssClass)),m(this.dropdown,this.opts.element,this.opts.adaptDropdownCssClass),this.dropdown.addClass(w(this.opts.dropdownCssClass))}),t.bind("propertychange.select2 DOMAttrModified.select2",e),"undefined"!=typeof WebKitMutationObserver&&(this.propertyObserver&&(delete this.propertyObserver,this.propertyObserver=null),this.propertyObserver=new WebKitMutationObserver(function(t){t.forEach(e)}),this.propertyObserver.observe(t.get(0),{attributes:!0,subtree:!1}))},triggerChange:function(t){t=t||{},t=e.extend({},t,{type:"change",val:this.val()}),this.opts.element.data("select2-change-triggered",!0),this.opts.element.trigger(t),this.opts.element.data("select2-change-triggered",!1),this.opts.element.click(),this.opts.blurOnChange&&this.opts.element.blur()},enable:function(){this.enabled||(this.enabled=!0,this.container.removeClass("select2-container-disabled"),this.opts.element.removeAttr("disabled"))},disable:function(){this.enabled&&(this.close(),this.enabled=!1,this.container.addClass("select2-container-disabled"),this.opts.element.attr("disabled","disabled"))},opened:function(){return this.container.hasClass("select2-dropdown-open")},positionDropdown:function(){var t,i,s,n=this.container.offset(),o=this.container.outerHeight(!1),a=this.container.outerWidth(!1),r=this.dropdown.outerHeight(!1),l=e(window).scrollLeft()+e(window).width(),c=e(window).scrollTop()+e(window).height(),d=n.top+o,h=n.left,u=c>=d+r,p=n.top-r>=this.body().scrollTop(),f=this.dropdown.outerWidth(!1),m=l>=h+f,g=this.dropdown.hasClass("select2-drop-above");this.body().css("position")!=="static"&&(t=this.body().offset(),d-=t.top,h-=t.left),g?(i=!0,!p&&u&&(i=!1)):(i=!1,!u&&p&&(i=!0)),m||(h=n.left+a-f),i?(d=n.top-r,this.container.addClass("select2-drop-above"),this.dropdown.addClass("select2-drop-above")):(this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")),s=e.extend({top:d,left:h,width:a},w(this.opts.dropdownCss)),this.dropdown.css(s)},shouldOpen:function(){var t;return this.opened()?!1:(t=e.Event("opening"),this.opts.element.trigger(t),!t.isDefaultPrevented())},clearDropdownAlignmentPreference:function(){this.container.removeClass("select2-drop-above"),this.dropdown.removeClass("select2-drop-above")},open:function(){return this.shouldOpen()?(window.setTimeout(this.bind(this.opening),1),!0):!1},opening:function(){function t(){return{width:Math.max(document.documentElement.scrollWidth,e(window).width()),height:Math.max(document.documentElement.scrollHeight,e(window).height())}}var i,s=this.containerId,n="scroll."+s,o="resize."+s,a="orientationchange."+s;this.clearDropdownAlignmentPreference(),this.container.addClass("select2-dropdown-open").addClass("select2-container-active"),this.dropdown[0]!==this.body().children().last()[0]&&this.dropdown.detach().appendTo(this.body()),this.updateResults(!0),i=e("#select2-drop-mask"),i.length==0&&(i=e(document.createElement("div")),i.attr("id","select2-drop-mask").attr("class","select2-drop-mask"),i.hide(),i.appendTo(this.body()),i.bind("mousedown touchstart",function(){var t,i=e("#select2-drop");i.length>0&&(t=i.data("select2"),t.opts.selectOnBlur&&t.selectHighlighted({noFocus:!0}),t.close())})),this.dropdown.prev()[0]!==i[0]&&this.dropdown.before(i),e("#select2-drop").removeAttr("id"),this.dropdown.attr("id","select2-drop"),i.css(t()),i.show(),this.dropdown.show(),this.positionDropdown(),this.dropdown.addClass("select2-drop-active"),this.ensureHighlightVisible();var r=this;this.container.parents().add(window).each(function(){e(this).bind(o+" "+n+" "+a,function(){e("#select2-drop-mask").css(t()),r.positionDropdown()})}),this.focusSearch()},close:function(){if(this.opened()){var t=this.containerId,i="scroll."+t,s="resize."+t,n="orientationchange."+t;this.container.parents().add(window).each(function(){e(this).unbind(i).unbind(s).unbind(n)}),this.clearDropdownAlignmentPreference(),e("#select2-drop-mask").hide(),this.dropdown.removeAttr("id"),this.dropdown.hide(),this.container.removeClass("select2-dropdown-open"),this.results.empty(),this.clearSearch(),this.search.removeClass("select2-active"),this.opts.element.trigger(e.Event("close"))}},clearSearch:function(){},getMaximumSelectionSize:function(){return w(this.opts.maximumSelectionSize)},ensureHighlightVisible:function(){var t,i,s,n,o,a,r,l=this.results;if(i=this.highlight(),!(0>i)){if(0==i)return l.scrollTop(0),void 0;t=this.findHighlightableChoices(),s=e(t[i]),n=s.offset().top+s.outerHeight(!0),i===t.length-1&&(r=l.find("li.select2-more-results"),r.length>0&&(n=r.offset().top+r.outerHeight(!0))),o=l.offset().top+l.outerHeight(!0),n>o&&l.scrollTop(l.scrollTop()+(n-o)),a=s.offset().top-l.offset().top,0>a&&s.css("display")!="none"&&l.scrollTop(l.scrollTop()+a)}},findHighlightableChoices:function(){return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)"),this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)")},moveHighlight:function(t){for(var i=this.findHighlightableChoices(),s=this.highlight();s>-1&&s<i.length;){s+=t;var n=e(i[s]);if(n.hasClass("select2-result-selectable")&&!n.hasClass("select2-disabled")&&!n.hasClass("select2-selected")){this.highlight(s);break}}},highlight:function(t){var s,n,o=this.findHighlightableChoices();return arguments.length===0?i(o.filter(".select2-highlighted")[0],o.get()):(t>=o.length&&(t=o.length-1),0>t&&(t=0),this.results.find(".select2-highlighted").removeClass("select2-highlighted"),s=e(o[t]),s.addClass("select2-highlighted"),this.ensureHighlightVisible(),n=s.data("select2-data"),n&&this.opts.element.trigger({type:"highlight",val:this.id(n),choice:n}),void 0)},countSelectableResults:function(){return this.findHighlightableChoices().length},highlightUnderEvent:function(t){var i=e(t.target).closest(".select2-result-selectable");if(i.length>0&&!i.is(".select2-highlighted")){var s=this.findHighlightableChoices();this.highlight(s.index(i))}else i.length==0&&this.results.find(".select2-highlighted").removeClass("select2-highlighted")},loadMoreIfNeeded:function(){var e,t=this.results,i=t.find("li.select2-more-results"),s=this.resultsPage+1,n=this,o=this.search.val(),a=this.context;i.length!==0&&(e=i.offset().top-t.offset().top-t.height(),e<=this.opts.loadMorePadding&&(i.addClass("select2-active"),this.opts.query({element:this.opts.element,term:o,page:s,context:a,matcher:this.opts.matcher,callback:this.bind(function(e){n.opened()&&(n.opts.populateResults.call(this,t,e.results,{term:o,page:s,context:a}),n.postprocessResults(e,!1,!1),e.more===!0?(i.detach().appendTo(t).text(n.opts.formatLoadMore(s+1)),window.setTimeout(function(){n.loadMoreIfNeeded()},10)):i.remove(),n.positionDropdown(),n.resultsPage=s,n.context=e.context)})})))},tokenize:function(){},updateResults:function(i){function n(){c.scrollTop(0),l.removeClass("select2-active"),h.positionDropdown()}function o(e){c.html(e),n()}var a,r,l=this.search,c=this.results,d=this.opts,h=this,u=l.val(),p=e.data(this.container,"select2-last-term");if((i===!0||!p||!s(u,p))&&(e.data(this.container,"select2-last-term",u),i===!0||this.showSearchInput!==!1&&this.opened())){var f=this.getMaximumSelectionSize();if(f>=1&&(a=this.data(),e.isArray(a)&&a.length>=f&&y(d.formatSelectionTooBig,"formatSelectionTooBig")))return o("<li class='select2-selection-limit'>"+d.formatSelectionTooBig(f)+"</li>"),void 0;if(l.val().length<d.minimumInputLength)return y(d.formatInputTooShort,"formatInputTooShort")?o("<li class='select2-no-results'>"+d.formatInputTooShort(l.val(),d.minimumInputLength)+"</li>"):o(""),void 0;if(d.maximumInputLength&&l.val().length>d.maximumInputLength)return y(d.formatInputTooLong,"formatInputTooLong")?o("<li class='select2-no-results'>"+d.formatInputTooLong(l.val(),d.maximumInputLength)+"</li>"):o(""),void 0;d.formatSearching&&this.findHighlightableChoices().length===0&&o("<li class='select2-searching'>"+d.formatSearching()+"</li>"),l.addClass("select2-active"),r=this.tokenize(),r!=t&&null!=r&&l.val(r),this.resultsPage=1,d.query({element:d.element,term:l.val(),page:this.resultsPage,context:null,matcher:d.matcher,callback:this.bind(function(a){var r;return this.opened()?(this.context=a.context===t?null:a.context,this.opts.createSearchChoice&&l.val()!==""&&(r=this.opts.createSearchChoice.call(null,l.val(),a.results),r!==t&&null!==r&&h.id(r)!==t&&h.id(r)!==null&&e(a.results).filter(function(){return s(h.id(this),h.id(r))}).length===0&&a.results.unshift(r)),a.results.length===0&&y(d.formatNoMatches,"formatNoMatches")?(o("<li class='select2-no-results'>"+d.formatNoMatches(l.val())+"</li>"),void 0):(c.empty(),h.opts.populateResults.call(this,c,a.results,{term:l.val(),page:this.resultsPage,context:null}),a.more===!0&&y(d.formatLoadMore,"formatLoadMore")&&(c.append("<li class='select2-more-results'>"+h.opts.escapeMarkup(d.formatLoadMore(this.resultsPage))+"</li>"),window.setTimeout(function(){h.loadMoreIfNeeded()},10)),this.postprocessResults(a,i),n(),this.opts.element.trigger({type:"loaded",data:a}),void 0)):(this.search.removeClass("select2-active"),void 0)})})}},cancel:function(){this.close()},blur:function(){this.opts.selectOnBlur&&this.selectHighlighted({noFocus:!0}),this.close(),this.container.removeClass("select2-container-active"),this.search[0]===document.activeElement&&this.search.blur(),this.clearSearch(),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus")},focusSearch:function(){h(this.search)},selectHighlighted:function(e){var t=this.highlight(),i=this.results.find(".select2-highlighted"),s=i.closest(".select2-result").data("select2-data");s&&(this.highlight(t),this.onSelect(s,e))},getPlaceholder:function(){return this.opts.element.attr("placeholder")||this.opts.element.attr("data-placeholder")||this.opts.element.data("placeholder")||this.opts.placeholder},initContainerWidth:function(){function i(){var i,s,n,o,a;if(this.opts.width==="off")return null;if(this.opts.width==="element")return this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px";if(this.opts.width==="copy"||this.opts.width==="resolve"){if(i=this.opts.element.attr("style"),i!==t)for(s=i.split(";"),o=0,a=s.length;a>o;o+=1)if(n=s[o].replace(/\s/g,"").match(/width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/),null!==n&&n.length>=1)return n[1];return this.opts.width==="resolve"?(i=this.opts.element.css("width"),i.indexOf("%")>0?i:this.opts.element.outerWidth(!1)===0?"auto":this.opts.element.outerWidth(!1)+"px"):null}return e.isFunction(this.opts.width)?this.opts.width():this.opts.width}var s=i.call(this);null!==s&&this.container.css("width",s)}}),S=x(T,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container"}).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>","   <span></span><abbr class='select2-search-choice-close' style='display:none;'></abbr>","   <div><b></b></div>","</a>","<input class='select2-focusser select2-offscreen' type='text'/>","<div class='select2-drop' style='display:none'>","   <div class='select2-search'>","       <input type='text' autocomplete='off' class='select2-input'/>","   </div>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.focusser.attr("disabled","disabled"))},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.focusser.removeAttr("disabled"))},opening:function(){this.parent.opening.apply(this,arguments),this.focusser.attr("disabled","disabled"),this.opts.element.trigger(e.Event("open"))},close:function(){this.opened()&&(this.parent.close.apply(this,arguments),this.focusser.removeAttr("disabled"),h(this.focusser))},focus:function(){this.opened()?this.close():(this.focusser.removeAttr("disabled"),this.focusser.focus())},isFocused:function(){return this.container.hasClass("select2-container-active")},cancel:function(){this.parent.cancel.apply(this,arguments),this.focusser.removeAttr("disabled"),this.focusser.focus()},initContainer:function(){var t,i=this.container,s=this.dropdown,n=!1;this.showSearch(this.opts.minimumResultsForSearch>=0),this.selection=t=i.find(".select2-choice"),this.focusser=i.find(".select2-focusser"),this.focusser.attr("id","s2id_autogen"+M()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.focusser.attr("id")),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===D.PAGE_UP||e.which===D.PAGE_DOWN)return u(e),void 0;switch(e.which){case D.UP:case D.DOWN:return this.moveHighlight(e.which===D.UP?-1:1),u(e),void 0;case D.TAB:case D.ENTER:return this.selectHighlighted(),u(e),void 0;case D.ESC:return this.cancel(e),u(e),void 0}}})),this.search.bind("blur",this.bind(function(){document.activeElement===this.body().get(0)&&window.setTimeout(this.bind(function(){this.search.focus()}),0)})),this.focusser.bind("keydown",this.bind(function(e){return!this.enabled||e.which===D.TAB||D.isControl(e)||D.isFunctionKey(e)||e.which===D.ESC?void 0:this.opts.openOnEnter===!1&&e.which===D.ENTER?(u(e),void 0):e.which==D.DOWN||e.which==D.UP||e.which==D.ENTER&&this.opts.openOnEnter?(this.open(),u(e),void 0):e.which==D.DELETE||e.which==D.BACKSPACE?(this.opts.allowClear&&this.clear(),u(e),void 0):void 0})),a(this.focusser),this.focusser.bind("keyup-change input",this.bind(function(e){this.opened()||(this.open(),this.showSearchInput!==!1&&this.search.val(this.focusser.val()),this.focusser.val(""),u(e))})),t.delegate("abbr","mousedown",this.bind(function(e){this.enabled&&(this.clear(),p(e),this.close(),this.selection.focus())})),t.bind("mousedown",this.bind(function(e){n=!0,this.opened()?this.close():this.enabled&&this.open(),u(e),n=!1})),s.bind("mousedown",this.bind(function(){this.search.focus()})),t.bind("focus",this.bind(function(e){u(e)})),this.focusser.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})).bind("blur",this.bind(function(){this.opened()||this.container.removeClass("select2-container-active")})),this.search.bind("focus",this.bind(function(){this.container.addClass("select2-container-active")})),this.initContainerWidth(),this.setPlaceholder()},clear:function(e){var t=this.selection.data("select2-data");t&&(this.opts.element.val(""),this.selection.find("span").empty(),this.selection.removeData("select2-data"),this.setPlaceholder(),e!==!1&&(this.opts.element.trigger({type:"removed",val:this.id(t),choice:t}),this.triggerChange({removed:t})))},initSelection:function(){if(this.opts.element.val()===""&&this.opts.element.text()==="")this.close(),this.setPlaceholder();else{var e=this;this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.setPlaceholder())})}},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(t,i){var s=t.find(":selected");e.isFunction(i)&&i({id:s.attr("value"),text:s.text(),element:s})}:"data"in t&&(t.initSelection=t.initSelection||function(i,n){var o=i.val(),a=null;t.query({matcher:function(e,i,n){var r=s(o,t.id(n));return r&&(a=n),r},callback:e.isFunction(n)?function(){n(a)}:e.noop})}),t},getPlaceholder:function(){return this.select&&this.select.find("option").first().text()!==""?t:this.parent.getPlaceholder.apply(this,arguments)},setPlaceholder:function(){var e=this.getPlaceholder();if(this.opts.element.val()===""&&e!==t){if(this.select&&this.select.find("option:first").text()!=="")return;this.selection.find("span").html(this.opts.escapeMarkup(e)),this.selection.addClass("select2-default"),this.selection.find("abbr").hide()}},postprocessResults:function(e,t,i){var n=0,o=this,a=!0;if(this.findHighlightableChoices().each2(function(e,t){return s(o.id(t.data("select2-data")),o.opts.element.val())?(n=e,!1):void 0}),i!==!1&&this.highlight(n),t===!0){var r=this.opts.minimumResultsForSearch;a=0>r?!1:C(e.results)>=r,this.showSearch(a)}},showSearch:function(t){this.showSearchInput=t,this.dropdown.find(".select2-search")[t?"removeClass":"addClass"]("select2-search-hidden"),e(this.dropdown,this.container)[t?"addClass":"removeClass"]("select2-with-searchbox")},onSelect:function(e,t){var i=this.opts.element.val();this.opts.element.val(this.id(e)),this.updateSelection(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),this.close(),t&&t.noFocus||this.selection.focus(),s(i,this.id(e))||this.triggerChange()},updateSelection:function(e){var i,s=this.selection.find("span");this.selection.data("select2-data",e),s.empty(),i=this.opts.formatSelection(e,s),i!==t&&s.append(this.opts.escapeMarkup(i)),this.selection.removeClass("select2-default"),this.opts.allowClear&&this.getPlaceholder()!==t&&this.selection.find("abbr").show()},val:function(){var e,i=!1,s=null,n=this;if(arguments.length===0)return this.opts.element.val();if(e=arguments[0],arguments.length>1&&(i=arguments[1]),this.select)this.select.val(e).find(":selected").each2(function(e,t){return s={id:t.attr("value"),text:t.text(),element:t.get(0)},!1}),this.updateSelection(s),this.setPlaceholder(),i&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("cannot call val() if initSelection() is not defined");if(!e&&0!==e)return this.clear(i),i&&this.triggerChange(),void 0;this.opts.element.val(e),this.opts.initSelection(this.opts.element,function(e){n.opts.element.val(e?n.id(e):""),n.updateSelection(e),n.setPlaceholder(),i&&n.triggerChange()})}},clearSearch:function(){this.search.val(""),this.focusser.val("")},data:function(e){var i;return arguments.length===0?(i=this.selection.data("select2-data"),i==t&&(i=null),i):(e&&""!==e?(this.opts.element.val(e?this.id(e):""),this.updateSelection(e)):this.clear(),void 0)}}),$=x(T,{createContainer:function(){var t=e(document.createElement("div")).attr({"class":"select2-container select2-container-multi"}).html(["    <ul class='select2-choices'>","  <li class='select2-search-field'>","    <input type='text' autocomplete='off' class='select2-input'>","  </li>","</ul>","<div class='select2-drop select2-drop-multi' style='display:none;'>","   <ul class='select2-results'>","   </ul>","</div>"].join(""));return t},prepareOpts:function(){var t=this.parent.prepareOpts.apply(this,arguments);return t.element.get(0).tagName.toLowerCase()==="select"?t.initSelection=function(e,t){var i=[];e.find(":selected").each2(function(e,t){i.push({id:t.attr("value"),text:t.text(),element:t[0]})}),t(i)}:"data"in t&&(t.initSelection=t.initSelection||function(i,o){var a=n(i.val(),t.separator),r=[];t.query({matcher:function(i,n,o){var l=e.grep(a,function(e){return s(e,t.id(o))}).length;return l&&r.push(o),l},callback:e.isFunction(o)?function(){o(r)}:e.noop})}),t},initContainer:function(){var t,i=".select2-choices";this.searchContainer=this.container.find(".select2-search-field"),this.selection=t=this.container.find(i),this.search.attr("id","s2id_autogen"+M()),e("label[for='"+this.opts.element.attr("id")+"']").attr("for",this.search.attr("id")),this.search.bind("input paste",this.bind(function(){this.enabled&&(this.opened()||this.open())})),this.search.bind("keydown",this.bind(function(e){if(this.enabled){if(e.which===D.BACKSPACE&&this.search.val()===""){this.close();var i,s=t.find(".select2-search-choice-focus");if(s.length>0)return this.unselect(s.first()),this.search.width(10),u(e),void 0;i=t.find(".select2-search-choice:not(.select2-locked)"),i.length>0&&i.last().addClass("select2-search-choice-focus")}else t.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus");if(this.opened())switch(e.which){case D.UP:case D.DOWN:return this.moveHighlight(e.which===D.UP?-1:1),u(e),void 0;case D.ENTER:case D.TAB:return this.selectHighlighted(),u(e),void 0;case D.ESC:return this.cancel(e),u(e),void 0}if(e.which!==D.TAB&&!D.isControl(e)&&!D.isFunctionKey(e)&&e.which!==D.BACKSPACE&&e.which!==D.ESC){if(e.which===D.ENTER){if(this.opts.openOnEnter===!1)return;if(e.altKey||e.ctrlKey||e.shiftKey||e.metaKey)return}this.open(),(e.which===D.PAGE_UP||e.which===D.PAGE_DOWN)&&u(e),e.which===D.ENTER&&u(e)}}})),this.search.bind("keyup",this.bind(this.resizeSearch)),this.search.bind("blur",this.bind(function(e){this.container.removeClass("select2-container-active"),this.search.removeClass("select2-focused"),this.opened()||this.clearSearch(),e.stopImmediatePropagation()})),this.container.delegate(i,"mousedown",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").length>0||(this.clearPlaceholder(),this.open(),this.focusSearch(),t.preventDefault()))})),this.container.delegate(i,"focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"),this.clearPlaceholder())})),this.initContainerWidth(),this.clearSearch()},enable:function(){this.enabled||(this.parent.enable.apply(this,arguments),this.search.removeAttr("disabled"))},disable:function(){this.enabled&&(this.parent.disable.apply(this,arguments),this.search.attr("disabled",!0))},initSelection:function(){if(this.opts.element.val()===""&&this.opts.element.text()===""&&(this.updateSelection([]),this.close(),this.clearSearch()),this.select||this.opts.element.val()!==""){var e=this;
this.opts.initSelection.call(null,this.opts.element,function(i){i!==t&&null!==i&&(e.updateSelection(i),e.close(),e.clearSearch())})}},clearSearch:function(){var e=this.getPlaceholder();e!==t&&this.getVal().length===0&&this.search.hasClass("select2-focused")===!1?(this.search.val(e).addClass("select2-default"),this.search.width(this.getMaxSearchWidth())):this.search.val("").width(10)},clearPlaceholder:function(){this.search.hasClass("select2-default")&&this.search.val("").removeClass("select2-default")},opening:function(){this.clearPlaceholder(),this.resizeSearch(),this.parent.opening.apply(this,arguments),this.focusSearch(),this.opts.element.trigger(e.Event("open"))},close:function(){this.opened()&&this.parent.close.apply(this,arguments)},focus:function(){this.close(),this.search.focus()},isFocused:function(){return this.search.hasClass("select2-focused")},updateSelection:function(t){var s=[],n=[],o=this;e(t).each(function(){i(o.id(this),s)<0&&(s.push(o.id(this)),n.push(this))}),t=n,this.selection.find(".select2-search-choice").remove(),e(t).each(function(){o.addSelectedChoice(this)}),o.postprocessResults()},tokenize:function(){var e=this.search.val();e=this.opts.tokenizer(e,this.data(),this.bind(this.onSelect),this.opts),null!=e&&e!=t&&(this.search.val(e),e.length>0&&this.open())},onSelect:function(e,t){this.addSelectedChoice(e),this.opts.element.trigger({type:"selected",val:this.id(e),choice:e}),(this.select||!this.opts.closeOnSelect)&&this.postprocessResults(),this.opts.closeOnSelect?(this.close(),this.search.width(10)):this.countSelectableResults()>0?(this.search.width(10),this.resizeSearch(),this.getMaximumSelectionSize()>0&&this.val().length>=this.getMaximumSelectionSize()&&this.updateResults(!0),this.positionDropdown()):(this.close(),this.search.width(10)),this.triggerChange({added:e}),t&&t.noFocus||this.focusSearch()},cancel:function(){this.close(),this.focusSearch()},addSelectedChoice:function(i){var s,n=!i.locked,o=e("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"),a=e("<li class='select2-search-choice select2-locked'><div></div></li>"),r=n?o:a,l=this.id(i),c=this.getVal();s=this.opts.formatSelection(i,r.find("div")),s!=t&&r.find("div").replaceWith("<div>"+this.opts.escapeMarkup(s)+"</div>"),n&&r.find(".select2-search-choice-close").bind("mousedown",u).bind("click dblclick",this.bind(function(t){this.enabled&&(e(t.target).closest(".select2-search-choice").fadeOut("fast",this.bind(function(){this.unselect(e(t.target)),this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"),this.close(),this.focusSearch()})).dequeue(),u(t))})).bind("focus",this.bind(function(){this.enabled&&(this.container.addClass("select2-container-active"),this.dropdown.addClass("select2-drop-active"))})),r.data("select2-data",i),r.insertBefore(this.searchContainer),c.push(l),this.setVal(c)},unselect:function(e){var t,s,n=this.getVal();if(e=e.closest(".select2-search-choice"),e.length===0)throw"Invalid argument: "+e+". Must be .select2-search-choice";t=e.data("select2-data"),t&&(s=i(this.id(t),n),s>=0&&(n.splice(s,1),this.setVal(n),this.select&&this.postprocessResults()),e.remove(),this.opts.element.trigger({type:"removed",val:this.id(t),choice:t}),this.triggerChange({removed:t}))},postprocessResults:function(){var e=this.getVal(),t=this.results.find(".select2-result"),s=this.results.find(".select2-result-with-children"),n=this;t.each2(function(t,s){var o=n.id(s.data("select2-data"));i(o,e)>=0&&(s.addClass("select2-selected"),s.find(".select2-result-selectable").addClass("select2-selected"))}),s.each2(function(e,t){t.is(".select2-result-selectable")||t.find(".select2-result-selectable:not(.select2-selected)").length!==0||t.addClass("select2-selected")}),this.highlight()==-1&&n.highlight(0)},getMaxSearchWidth:function(){return this.selection.width()-o(this.search)},resizeSearch:function(){var e,t,i,s,n,a=o(this.search);e=f(this.search)+10,t=this.search.offset().left,i=this.selection.width(),s=this.selection.offset().left,n=i-(t-s)-a,e>n&&(n=i-a),40>n&&(n=i-a),0>=n&&(n=e),this.search.width(n)},getVal:function(){var e;return this.select?(e=this.select.val(),null===e?[]:e):(e=this.opts.element.val(),n(e,this.opts.separator))},setVal:function(t){var s;this.select?this.select.val(t):(s=[],e(t).each(function(){i(this,s)<0&&s.push(this)}),this.opts.element.val(s.length===0?"":s.join(this.opts.separator)))},val:function(){var i,s=!1,n=this;if(arguments.length===0)return this.getVal();if(i=arguments[0],arguments.length>1&&(s=arguments[1]),!i&&0!==i)return this.opts.element.val(""),this.updateSelection([]),this.clearSearch(),s&&this.triggerChange(),void 0;if(this.setVal(i),this.select)this.opts.initSelection(this.select,this.bind(this.updateSelection)),s&&this.triggerChange();else{if(this.opts.initSelection===t)throw new Error("val() cannot be called if initSelection() is not defined");this.opts.initSelection(this.opts.element,function(t){var i=e(t).map(n.id);n.setVal(i),n.updateSelection(t),n.clearSearch(),s&&n.triggerChange()})}this.clearSearch()},onSortStart:function(){if(this.select)throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.");this.search.width(0),this.searchContainer.hide()},onSortEnd:function(){var t=[],i=this;this.searchContainer.show(),this.searchContainer.appendTo(this.searchContainer.parent()),this.resizeSearch(),this.selection.find(".select2-search-choice").each(function(){t.push(i.opts.id(e(this).data("select2-data")))}),this.setVal(t),this.triggerChange()},data:function(t){var i,s=this;return arguments.length===0?this.selection.find(".select2-search-choice").map(function(){return e(this).data("select2-data")}).get():(t||(t=[]),i=e.map(t,function(e){return s.opts.id(e)}),this.setVal(i),this.updateSelection(t),this.clearSearch(),void 0)}}),e.fn.select2=function(){var s,n,o,a,r=Array.prototype.slice.call(arguments,0),l=["val","destroy","opened","open","close","focus","isFocused","container","onSortStart","onSortEnd","enable","disable","positionDropdown","data"];return this.each(function(){if(r.length===0||typeof r[0]=="object")s=r.length===0?{}:e.extend({},r[0]),s.element=e(this),s.element.get(0).tagName.toLowerCase()==="select"?a=s.element.attr("multiple"):(a=s.multiple||!1,"tags"in s&&(s.multiple=a=!0)),n=a?new $:new S,n.init(s);else{if(typeof r[0]!="string")throw"Invalid arguments to select2 plugin: "+r;if(i(r[0],l)<0)throw"Unknown method: "+r[0];if(o=t,n=e(this).data("select2"),n===t)return;if(o=r[0]==="container"?n.container:n[r[0]].apply(n,r.slice(1)),o!==t)return!1}}),o===t?this:o},e.fn.select2.defaults={width:"copy",loadMorePadding:0,closeOnSelect:!0,openOnEnter:!0,containerCss:{},dropdownCss:{},containerCssClass:"",dropdownCssClass:"",formatResult:function(e,t,i,s){var n=[];return g(e.text,i.term,n,s),n.join("")},formatSelection:function(e){return e?e.text:t},sortResults:function(e){return e},formatResultCssClass:function(){return t},formatNoMatches:function(){return"No matches found"},formatInputTooShort:function(e,t){var i=t-e.length;return"Please enter "+i+" more character"+(1==i?"":"s")},formatInputTooLong:function(e,t){var i=e.length-t;return"Please delete "+i+" character"+(1==i?"":"s")},formatSelectionTooBig:function(e){return"You can only select "+e+" item"+(1==e?"":"s")},formatLoadMore:function(){return"Loading more results..."},formatSearching:function(){return"Searching..."},minimumResultsForSearch:0,minimumInputLength:0,maximumInputLength:null,maximumSelectionSize:0,id:function(e){return e.id},matcher:function(e,t){return(""+t).toUpperCase().indexOf((""+e).toUpperCase())>=0},separator:",",tokenSeparators:[],tokenizer:k,escapeMarkup:function(e){var t={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;","/":"&#47;"};return String(e).replace(/[&<>"'\/\\]/g,function(e){return t[e[0]]})},blurOnChange:!1,selectOnBlur:!1,adaptContainerCssClass:function(e){return e},adaptDropdownCssClass:function(){return null}},window.Select2={query:{ajax:v,local:b,tags:_},util:{debounce:l,markMatch:g},"class":{"abstract":T,single:S,multi:$}}}}(jQuery),function(){this.Api={users_path:"/users/search?q=:query",user_path:"/users/search?id=:user_id",projects_path:"/projects/search?q=:query",project_path:"/projects/search?id=:project_id",user:function(e,t){var i;return i=Api.user_path.replace(":user_id",e),$.ajax({url:i,dataType:"json"}).done(function(e){return t(e)})},users:function(e,t,i){var s;return s=Api.users_path.replace(":query",e),"undefined"==typeof i&&(i=gon.enterprise_id),this.delayRequest(function(){return $.ajax({url:s,data:{page:1,per_page:10,enterprise_id:i},dataType:"json"}).done(function(e){return t(e)})})},delayRequest:function(e,t){return t=t||800,this.tid&&clearTimeout(this.tid),this.tid=setTimeout(e,t)},project:function(e,t){var i;return i=Api.project_path.replace(":project_id",e),$.ajax({url:i,dataType:"json"}).done(function(e){return t(e)})},projects:function(e,t){var i;return i=Api.projects_path.replace(":query",e),$.ajax({url:i,data:{page:1,per_page:10},dataType:"json"}).done(function(e){return t(e)})}}}.call(this),function(){$(function(){var e,t,i,s;return $.extend($.fn.select2.defaults,{formatNoMatches:function(){return""},formatInputTooShort:function(e,t){return""+(t-e.length)+""},formatInputTooLong:function(e,t){return""+(e.length-t)+""},formatSelectionTooBig:function(e){return""+e+""},formatLoadMore:function(){return"..."},formatSearching:function(){return"..."}}),i=[],s={placeholder:"",multiple:$(".ajax-users-select").hasClass("multiselect"),minimumInputLength:2,query:function(e){return Api.users(e.term,function(t){return i=t,e.callback({results:t})},parseInt(window.usersSelectPlacehold)||0)},tags:!0,tokenSeparators:[","," ",";"],createSearchChoice:function(e){var t;return window.disabledEmailSearch?!1:$.fn.form.settings.regExp.email.test(e)&&i.length===0?t={id:$.trim(e),text:$.trim(e),avatar:"no_portrait.png",name:$.trim(e),username:$.trim(e)}:void 0},formatResult:function(e){var t,i,s;return t=e.avatar,i=new RegExp("no_portrait.png"),i.test(t)&&(t=LetterAvatar(e.name)),s="<div class='user-result'>\n  <div class='user-image'><img class='ui circular image' style='width: 37px; height: 37px; margin-right: 5px;' src='"+t+"'></div>\n  <div class='user-name'>"+sanitize(e.name)+"</div>\n  <div class='user-username'>"+e.username+"</div>\n</div>"},formatSelection:function(e){return sanitize(e.name)},dropdownCssClass:"ajax-users-dropdown",escapeMarkup:function(e){return e}},$(".ajax-users-select").select2(s),e={query:function(e){return Api.users(e.term,function(t){return e.callback({results:t})},parseInt(window.usersSelectPlacehold)||0)}},t=function(){var t,i,n;n={};for(t in s)n[t]=s[t];for(i in e)n[i]=e[i];return n},$(".ajax-enterprise-users").select2(t()),$(".ajax-projects-select").select2({placeholder:"",multiple:$(".ajax-projects-select").hasClass("multiselect"),minimumInputLength:3,query:function(e){return Api.projects(e.term,function(t){var i;return i={results:t},e.callback(i)})},initSelection:function(e,t){var i;return i=$(e).val(),""!==i?Api.project(i,t):void 0},formatResult:function(e){return sanitize(e.name)},formatSelection:function(e){return sanitize(e.name)},dropdownCssClass:"ajax-projects-dropdown"})})}.call(this),function(e){var t;t=e.fn.chosen,e.fn.extend({chosen:function(i){var s;return s={search_contains:"true"},e.extend(s,i),t.apply(this,[s])},disable:function(){return e(this).attr("disabled","disabled").addClass("disabled")},enable:function(){return e(this).removeAttr("disabled").removeClass("disabled")}})}(jQuery),function(e,t,i,s){"use strict";e.fn.search=function(i){var n,o=e(this),a=o.selector||"",r=(new Date).getTime(),l=[],c=arguments[0],d="string"==typeof c,h=[].slice.call(arguments,1);return e(this).each(function(){var u,p=e.extend(!0,{},e.fn.search.settings,i),f=p.className,m=p.selector,g=p.error,v=p.namespace,b="."+v,_=v+"-module",y=e(this),w=y.find(m.prompt),C=y.find(m.searchButton),k=y.find(m.results),x=(y.find(m.result),y.find(m.category),this),D=y.data(_);u={initialize:function(){u.verbose("Initializing module");var e=w[0],t=e!==s&&e.oninput!==s?"input":e!==s&&e.onpropertychange!==s?"propertychange":"keyup";p.automatic&&w.on(t+b,u.search.throttle),w.on("focus"+b,u.event.focus).on("blur"+b,u.event.blur).on("keydown"+b,u.handleKeyboard),C.on("click"+b,u.search.query),k.on("mousedown"+b,u.event.mousedown).on("mouseup"+b,u.event.mouseup).on("click"+b,m.result,u.results.select),u.instantiate()},instantiate:function(){u.verbose("Storing instance of module",u),D=u,y.data(_,u)},destroy:function(){u.verbose("Destroying instance"),y.removeData(_),w.off(b),C.off(b),k.off(b)},event:{focus:function(){y.addClass(f.focus),clearTimeout(u.timer),u.search.throttle(),u.has.minimum()&&u.results.show()},mousedown:function(){u.resultsClicked=!0},mouseup:function(){u.resultsClicked=!1},blur:function(){u.search.cancel(),y.removeClass(f.focus),u.resultsClicked||(u.timer=setTimeout(u.results.hide,p.hideDelay))}},handleKeyboard:function(t){var i,s=y.find(m.result),n=y.find(m.category),o=t.which,a={backspace:8,enter:13,escape:27,upArrow:38,downArrow:40},r=f.active,l=s.index(s.filter("."+r)),c=s.size();if(o==a.escape&&(u.verbose("Escape key pressed, blurring search field"),w.trigger("blur")),k.filter(":visible").size()>0)if(o==a.enter){if(u.verbose("Enter key pressed, selecting active result"),s.filter("."+r).size()>0)return e.proxy(u.results.select,s.filter("."+r))(t),t.preventDefault(),!1}else o==a.upArrow?(u.verbose("Up key pressed, changing active result"),i=0>l-1?l:l-1,n.removeClass(r),s.removeClass(r).eq(i).addClass(r).closest(n).addClass(r),t.preventDefault()):o==a.downArrow&&(u.verbose("Down key pressed, changing active result"),i=l+1>=c?l:l+1,n.removeClass(r),s.removeClass(r).eq(i).addClass(r).closest(n).addClass(r),t.preventDefault());else o==a.enter&&(u.verbose("Enter key pressed, executing query"),u.search.query(),C.addClass(f.down),w.one("keyup",function(){C.removeClass(f.down)}))},has:{minimum:function(){var e=w.val(),t=e.length;return t>=p.minCharacters}},search:{cancel:function(){var e=y.data("xhr")||!1;e&&e.state()!="resolved"&&(u.debug("Cancelling last search"),e.abort())},throttle:function(){clearTimeout(u.timer),u.has.minimum()?u.timer=setTimeout(u.search.query,p.searchDelay):u.results.hide()},query:function(){var t=w.val(),i=u.search.cache.read(t);i?(u.debug("Reading result for '"+t+"' from cache"),u.results.add(i)):(u.debug("Querying for '"+t+"'"),e.isPlainObject(p.source)||e.isArray(p.source)?u.search.local(t):p.apiSettings?u.search.remote(t):e.fn.api!==s&&e.api.settings.api.search!==s?(u.debug("Searching with default search API endpoint"),p.apiSettings={action:"search"},u.search.remote(t)):u.error(g.source),e.proxy(p.onSearchQuery,y)(t))},local:function(t){var i,s=[],n=[],o=e.isArray(p.searchFields)?p.searchFields:[p.searchFields],a=new RegExp("(?:s|^)"+t,"i"),r=new RegExp(t,"i");y.addClass(f.loading),e.each(o,function(t,i){e.each(p.source,function(t,o){var l=typeof o[i]=="string",c=e.inArray(o,s)==-1&&e.inArray(o,n)==-1;l&&c&&(a.test(o[i])?s.push(o):p.searchFullText&&r.test(o[i])&&n.push(o))})}),i=u.results.generate({results:e.merge(s,n)}),y.removeClass(f.loading),u.search.cache.write(t,i),u.results.add(i)},remote:function(t){var i,s={stateContext:y,urlData:{query:t},onSuccess:function(e){i=u.results.generate(e),u.search.cache.write(t,i),u.results.add(i)},onFailure:u.error};u.search.cancel(),u.debug("Executing search"),e.extend(!0,s,p.apiSettings),e.api(s)},cache:{read:function(e){var t=y.data("cache");return p.cache&&"object"==typeof t&&t[e]!==s?t[e]:!1},write:function(e,t){var i=y.data("cache")!==s?y.data("cache"):{};i[e]=t,y.data("cache",i)}}},results:{generate:function(t){u.debug("Generating html from response",t);var i=p.templates[p.type],s="";return e.isPlainObject(t.results)&&!e.isEmptyObject(t.results)||e.isArray(t.results)&&t.results.length>0?(p.maxResults>0&&(t.results=e.isArray(t.results)?t.results.slice(0,p.maxResults):t.results),e.isFunction(i)?s=i(t):u.error(g.noTemplate,!1)):s=u.message(g.noResults,"empty"),e.proxy(p.onResults,y)(t),s},add:function(t){(p.onResultsAdd=="default"||e.proxy(p.onResultsAdd,k)(t)=="default")&&k.html(t),u.results.show()},show:function(){k.filter(":visible").size()===0&&w.filter(":focus").size()>0&&k.html()!==""&&(p.transition&&e.fn.transition!==s&&y.transition("is supported")&&!k.transition("is inward")?(u.debug("Showing results with css animations"),k.transition({animation:p.transition+" in",duration:p.duration,queue:!0})):(u.debug("Showing results with javascript"),k.stop().fadeIn(p.duration,p.easing)),e.proxy(p.onResultsOpen,k)())},hide:function(){k.filter(":visible").size()>0&&(p.transition&&e.fn.transition!==s&&y.transition("is supported")&&!k.transition("is outward")?(u.debug("Hiding results with css animations"),k.transition({animation:p.transition+" out",duration:p.duration,queue:!0})):(u.debug("Hiding results with javascript"),k.stop().fadeIn(p.duration,p.easing)),e.proxy(p.onResultsClose,k)())},select:function(i){u.debug("Search result selected");var s=e(this),n=s.find(".title");if(n.html(),p.onSelect=="default"||e.proxy(p.onSelect,this)(i)=="default"){var o=s.find("a[href]").eq(0),n=s.find(m.title).eq(0),a=o.attr("href")||!1,r=o.attr("target")||!1,l=n.size()>0?n.text():!1;u.results.hide(),l&&w.val(l),a&&("_blank"==r||i.ctrlKey?t.open(a):t.location.href=a)}}},message:function(e,t){return t=t||"standard",u.results.add(p.templates.message(e,t)),p.templates.message(e,t)},setting:function(t,i){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(i===s)return p[t];p[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,u,t);else{if(i===s)return u[t];u[t]=i}},debug:function(){p.debug&&(p.performance?u.performance.log(arguments):(u.debug=Function.prototype.bind.call(console.info,console,p.name+":"),u.debug.apply(console,arguments)))},verbose:function(){p.verbose&&p.debug&&(p.performance?u.performance.log(arguments):(u.verbose=Function.prototype.bind.call(console.info,console,p.name+":"),u.verbose.apply(console,arguments)))},error:function(){u.error=Function.prototype.bind.call(console.error,console,p.name+":"),u.error.apply(console,arguments)},performance:{log:function(e){var t,i,s;p.performance&&(t=(new Date).getTime(),s=r||t,i=t-s,r=t,l.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:x,"Execution Time":i})),clearTimeout(u.performance.timer),u.performance.timer=setTimeout(u.performance.display,100)},display:function(){var t=p.name+":",i=0;r=!1,clearTimeout(u.performance.timer),e.each(l,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",a&&(t+=" '"+a+"'"),o.size()>1&&(t+=" ("+o.size()+")"),(console.group!==s||console.table!==s)&&l.length>0&&(console.groupCollapsed(t),console.table?console.table(l):e.each(l,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),l=[]}},invoke:function(t,i,o){var a,r,l,c=D;return i=i||h,o=x||o,"string"==typeof t&&c!==s&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(i,n){var o=i!=a?n+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=a)c=c[o];else{if(c[o]!==s)return r=c[o],!1;if(!e.isPlainObject(c[n])||i==a)return c[n]!==s?(r=c[n],!1):!1;c=c[n]}})),e.isFunction(r)?l=r.apply(o,i):r!==s&&(l=r),e.isArray(n)?n.push(l):n!==s?n=[n,l]:l!==s&&(n=l),r}},d?(D===s&&u.initialize(),u.invoke(c)):(D!==s&&u.destroy(),u.initialize())}),n!==s?n:this},e.fn.search.settings={name:"Search Module",namespace:"search",debug:!1,verbose:!0,performance:!0,apiSettings:!1,type:"standard",minCharacters:1,source:!1,searchFields:["title","description"],searchFullText:!0,automatic:"true",hideDelay:0,searchDelay:300,maxResults:7,cache:!0,transition:"scale",duration:300,easing:"easeOutExpo",onSelect:"default",onResultsAdd:"default",onSearchQuery:function(){},onResults:function(){},onResultsOpen:function(){},onResultsClose:function(){},className:{active:"active",down:"down",focus:"focus",empty:"empty",loading:"loading"},error:{source:"Cannot search. No source used, and Semantic API module was not included",noResults:"Your search returned no results",logging:"Error in debug logging, exiting.",noTemplate:"A valid template name was not specified.",serverError:"There was an issue with querying the server.",method:"The method you called is not defined."},selector:{prompt:".prompt",searchButton:".search.button",results:".results",category:".category",result:".result",title:".title, .name"},templates:{escape:function(e){var t=/[&<>"'`]/g,i=/[&<>"'`]/,s={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=function(e){return s[e]};return i.test(e)?e.replace(t,n):e},message:function(e,t){var i="";return e!==s&&t!==s&&(i+='<div class="message '+t+'">',i+="empty"==t?'<div class="header">No Results</div class="header"><div class="description">'+e+'</div class="description">':' <div class="description">'+e+"</div>",i+="</div>"),i},category:function(t){var i="",n=e.fn.search.settings.templates.escape;return t.results!==s?(e.each(t.results,function(t,o){o.results!==s&&o.results.length>0&&(i+='<div class="category"><div class="name">'+o.name+"</div>",e.each(o.results,function(e,t){i+='<div class="result">',t.url&&(i+='<a href="'+t.url+'"></a>'),t.image!==s&&(t.image=n(t.image),i+='<div class="image"> <img src="'+t.image+'" alt="">'+"</div>"),i+='<div class="content">',t.price!==s&&(t.price=n(t.price),i+='<div class="price">'+t.price+"</div>"),t.title!==s&&(t.title=n(t.title),i+='<div class="title">'+t.title+"</div>"),t.description!==s&&(i+='<div class="description">'+t.description+"</div>"),i+="</div></div>"}),i+="</div>")}),t.action&&(i+='<a href="'+t.action.url+'" class="action">'+t.action.text+"</a>"),i):!1},standard:function(t){var i="";return t.results!==s?(e.each(t.results,function(e,t){i+=t.url?'<a class="result" href="'+t.url+'">':'<a class="result">',t.image!==s&&(i+='<div class="image"> <img src="'+t.image+'">'+"</div>"),i+='<div class="content">',t.price!==s&&(i+='<div class="price">'+t.price+"</div>"),t.title!==s&&(i+='<div class="title">'+t.title+"</div>"),t.description!==s&&(i+='<div class="description">'+t.description+"</div>"),i+="</div>",i+="</a>"}),t.action&&(i+='<a href="'+t.action.url+'" class="action">'+t.action.text+"</a>"),i):!1}}}}(jQuery,window,document),function(e,t,i,s){"use strict";t="undefined"!=typeof t&&t.Math==Math?t:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.modal=function(n){var o,a=e(this),r=e(t),l=e(i),c=e("body"),d=a.selector||"",h=(new Date).getTime(),u=[],p=arguments[0],f="string"==typeof p,m=[].slice.call(arguments,1),g=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame||function(e){setTimeout(e,0)};return a.each(function(){var a,v,b,_,y,w,C,k,x,D=e.isPlainObject(n)?e.extend(!0,{},e.fn.modal.settings,n):e.extend({},e.fn.modal.settings),T=D.selector,S=D.className,$=D.namespace,M=D.error,j="."+$,F="module-"+$,U=e(this),A=e(D.context),N=U.find(T.close),O=this,I=U.data(F),P=!1;x={initialize:function(){x.verbose("Initializing dimmer",A),x.create.id(),x.create.dimmer(),x.refreshModals(),x.bind.events(),D.observeChanges&&x.observeChanges(),x.instantiate()},instantiate:function(){x.verbose("Storing instance of modal"),I=x,U.data(F,I)},create:{dimmer:function(){var t={debug:D.debug,dimmerName:"modals"},i=e.extend(!0,t,D.dimmerSettings);return e.fn.dimmer===s?(x.error(M.dimmer),void 0):(x.debug("Creating dimmer"),_=A.dimmer(i),D.detachable?(x.verbose("Modal is detachable, moving content into dimmer"),_.dimmer("add content",U)):x.set.undetached(),y=_.dimmer("get dimmer"),void 0)},id:function(){C=(Math.random().toString(16)+"000000000").substr(2,8),w="."+C,x.verbose("Creating unique id for element",C)}},destroy:function(){x.verbose("Destroying previous modal"),U.removeData(F).off(j),r.off(w),y.off(w),N.off(j),A.dimmer("destroy")},observeChanges:function(){"MutationObserver"in t&&(k=new MutationObserver(function(){x.debug("DOM tree modified, refreshing"),x.refresh()}),k.observe(O,{childList:!0,subtree:!0}),x.debug("Setting up mutation observer",k))},refresh:function(){x.remove.scrolling(),x.cacheSizes(),x.set.screenHeight(),x.set.type(),x.set.position()},refreshModals:function(){v=U.siblings(T.modal),a=v.add(U)},attachEvents:function(t,i){var s=e(t);i=e.isFunction(x[i])?x[i]:x.toggle,s.length>0?(x.debug("Attaching modal events to element",t,i),s.off(j).on("click"+j,i)):x.error(M.notFound,t)},bind:{events:function(){x.verbose("Attaching events"),U.on("click"+j,T.close,x.event.close).on("click"+j,T.approve,x.event.approve).on("click"+j,T.deny,x.event.deny),r.on("resize"+w,x.event.resize)}},get:{id:function(){return(Math.random().toString(16)+"000000000").substr(2,8)}},event:{approve:function(){return P||D.onApprove.call(O,e(this))===!1?(x.verbose("Approve callback returned false cancelling hide"),void 0):(P=!0,x.hide(function(){P=!1}),void 0)},deny:function(){return P||D.onDeny.call(O,e(this))===!1?(x.verbose("Deny callback returned false cancelling hide"),void 0):(P=!0,x.hide(function(){P=!1}),void 0)},close:function(){x.hide()},click:function(t){var s=e(t.target),n=s.closest(T.modal).length>0,o=e.contains(i.documentElement,t.target);!n&&o&&(x.debug("Dimmer clicked, hiding all modals"),x.is.active()&&(x.remove.clickaway(),D.allowMultiple?x.hide():x.hideAll()))},debounce:function(e,t){clearTimeout(x.timer),x.timer=setTimeout(e,t)},keyboard:function(e){var t=e.which,i=27;t==i&&(D.closable?(x.debug("Escape key pressed hiding modal"),x.hide()):x.debug("Escape key pressed, but closable is set to false"),e.preventDefault())},resize:function(){_.dimmer("is active")&&(x.is.animating()||x.is.active())&&g(x.refresh)}},toggle:function(){x.is.active()||x.is.animating()?x.hide():x.show()},show:function(t){t=e.isFunction(t)?t:function(){},x.refreshModals(),x.set.dimmerSettings(),x.showModal(t)},hide:function(t){t=e.isFunction(t)?t:function(){},x.refreshModals(),x.hideModal(t)},showModal:function(t){t=e.isFunction(t)?t:function(){},x.is.animating()||!x.is.active()?(x.showDimmer(),x.cacheSizes(),x.set.position(),x.set.screenHeight(),x.set.type(),x.set.clickaway(),!D.allowMultiple&&x.others.active()?x.hideOthers(x.showModal):(D.allowMultiple&&D.detachable&&U.detach().appendTo(y),D.onShow.call(O),D.transition&&e.fn.transition!==s&&U.transition("is supported")?(x.debug("Showing modal with css animations"),U.transition({debug:D.debug,animation:D.transition+" in",queue:D.queue,duration:D.duration,useFailSafe:!0,onComplete:function(){D.onVisible.apply(O),D.keyboardShortcuts&&x.add.keyboardShortcuts(),x.save.focus(),x.set.active(),D.autofocus&&x.set.autofocus(),t()}})):x.error(M.noTransition))):x.debug("Modal is already visible")},hideModal:function(t,i){return t=e.isFunction(t)?t:function(){},x.debug("Hiding modal"),D.onHide.call(O,e(this))===!1?(x.verbose("Hide callback returned false cancelling hide"),void 0):((x.is.animating()||x.is.active())&&(D.transition&&e.fn.transition!==s&&U.transition("is supported")?(x.remove.active(),U.transition({debug:D.debug,animation:D.transition+" out",queue:D.queue,duration:D.duration,useFailSafe:!0,onStart:function(){x.others.active()||i||x.hideDimmer(),D.keyboardShortcuts&&x.remove.keyboardShortcuts()},onComplete:function(){D.onHidden.call(O),x.restore.focus(),t()}})):x.error(M.noTransition)),void 0)},showDimmer:function(){_.dimmer("is animating")||!_.dimmer("is active")?(x.debug("Showing dimmer"),_.dimmer("show")):x.debug("Dimmer already visible")},hideDimmer:function(){return _.dimmer("is animating")||_.dimmer("is active")?(_.dimmer("hide",function(){x.remove.clickaway(),x.remove.screenHeight()}),void 0):(x.debug("Dimmer is not visible cannot hide"),void 0)},hideAll:function(t){var i=a.filter("."+S.active+", ."+S.animating);t=e.isFunction(t)?t:function(){},i.length>0&&(x.debug("Hiding all visible modals"),x.hideDimmer(),i.modal("hide modal",t))},hideOthers:function(t){var i=v.filter("."+S.active+", ."+S.animating);t=e.isFunction(t)?t:function(){},i.length>0&&(x.debug("Hiding other modals",v),i.modal("hide modal",t,!0))},others:{active:function(){return v.filter("."+S.active).length>0},animating:function(){return v.filter("."+S.animating).length>0}},add:{keyboardShortcuts:function(){x.verbose("Adding keyboard shortcuts"),l.on("keyup"+j,x.event.keyboard)}},save:{focus:function(){b=e(i.activeElement).blur()}},restore:{focus:function(){b&&b.length>0&&b.focus()}},remove:{active:function(){U.removeClass(S.active)},clickaway:function(){D.closable&&y.off("click"+w)},bodyStyle:function(){c.attr("style")===""&&(x.verbose("Removing style attribute"),c.removeAttr("style"))},screenHeight:function(){x.debug("Removing page height"),c.css("height","")},keyboardShortcuts:function(){x.verbose("Removing keyboard shortcuts"),l.off("keyup"+j)},scrolling:function(){_.removeClass(S.scrolling),U.removeClass(S.scrolling)}},cacheSizes:function(){U.addClass(S.loading);var n=U.prop("scrollHeight"),o=U.outerHeight();(x.cache===s||0!==o)&&(x.cache={pageHeight:e(i).outerHeight(),height:o+D.offset,scrollHeight:n+D.offset,contextHeight:D.context=="body"?e(t).height():_.height()},x.cache.topOffset=-(x.cache.height/2)),U.removeClass(S.loading),x.debug("Caching modal and container sizes",x.cache)},can:{fit:function(){var e=x.cache.contextHeight,t=x.cache.contextHeight/2,i=x.cache.topOffset,s=x.cache.scrollHeight,n=x.cache.height,o=D.padding,a=t+i;return s>n?e>a+s+o:e>n+2*o}},is:{active:function(){return U.hasClass(S.active)},animating:function(){return U.transition("is supported")?U.transition("is animating"):U.is(":visible")},scrolling:function(){return _.hasClass(S.scrolling)},modernBrowser:function(){return!(t.ActiveXObject||"ActiveXObject"in t)}},set:{autofocus:function(){var e=U.find("[tabindex], :input").filter(":visible"),t=e.filter("[autofocus]"),i=t.length>0?t.first():e.first();i.length>0&&i.focus()},clickaway:function(){D.closable&&y.on("click"+w,x.event.click)},dimmerSettings:function(){if(e.fn.dimmer===s)return x.error(M.dimmer),void 0;var t={debug:D.debug,dimmerName:"modals",variation:!1,closable:"auto",duration:{show:D.duration,hide:D.duration}},i=e.extend(!0,t,D.dimmerSettings);D.inverted?(i.variation=i.variation!==s?i.variation+" inverted":"inverted",y.addClass(S.inverted)):y.removeClass(S.inverted),D.blurring?_.addClass(S.blurring):_.removeClass(S.blurring),A.dimmer("setting",i)},screenHeight:function(){x.can.fit()?c.css("height",""):(x.debug("Modal is taller than page content, resizing page height"),c.css("height",x.cache.height+D.padding*2))},active:function(){U.addClass(S.active)},scrolling:function(){_.addClass(S.scrolling),U.addClass(S.scrolling)},type:function(){x.can.fit()?(x.verbose("Modal fits on screen"),x.others.active()||x.others.animating()||x.remove.scrolling()):(x.verbose("Modal cannot fit on screen setting to scrolling"),x.set.scrolling())},position:function(){x.verbose("Centering modal on page",x.cache),x.can.fit()?U.css({top:"",marginTop:x.cache.topOffset}):U.css({marginTop:"",top:l.scrollTop()})},undetached:function(){_.addClass(S.undetached)}},setting:function(t,i){if(x.debug("Changing setting",t,i),e.isPlainObject(t))e.extend(!0,D,t);else{if(i===s)return D[t];e.isPlainObject(D[t])?e.extend(!0,D[t],i):D[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,x,t);else{if(i===s)return x[t];x[t]=i}},debug:function(){!D.silent&&D.debug&&(D.performance?x.performance.log(arguments):(x.debug=Function.prototype.bind.call(console.info,console,D.name+":"),x.debug.apply(console,arguments)))},verbose:function(){!D.silent&&D.verbose&&D.debug&&(D.performance?x.performance.log(arguments):(x.verbose=Function.prototype.bind.call(console.info,console,D.name+":"),x.verbose.apply(console,arguments)))},error:function(){D.silent||(x.error=Function.prototype.bind.call(console.error,console,D.name+":"),x.error.apply(console,arguments))},performance:{log:function(e){var t,i,s;D.performance&&(t=(new Date).getTime(),s=h||t,i=t-s,h=t,u.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:O,"Execution Time":i})),clearTimeout(x.performance.timer),x.performance.timer=setTimeout(x.performance.display,500)},display:function(){var t=D.name+":",i=0;h=!1,clearTimeout(x.performance.timer),e.each(u,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",d&&(t+=" '"+d+"'"),(console.group!==s||console.table!==s)&&u.length>0&&(console.groupCollapsed(t),console.table?console.table(u):e.each(u,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),u=[]}},invoke:function(t,i,n){var a,r,l,c=I;return i=i||m,n=O||n,"string"==typeof t&&c!==s&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(i,n){var o=i!=a?n+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;
if(e.isPlainObject(c[o])&&i!=a)c=c[o];else{if(c[o]!==s)return r=c[o],!1;if(!e.isPlainObject(c[n])||i==a)return c[n]!==s?(r=c[n],!1):!1;c=c[n]}})),e.isFunction(r)?l=r.apply(n,i):r!==s&&(l=r),e.isArray(o)?o.push(l):o!==s?o=[o,l]:l!==s&&(o=l),r}},f?(I===s&&x.initialize(),x.invoke(p)):(I!==s&&I.invoke("destroy"),x.initialize())}),o!==s?o:this},e.fn.modal.settings={name:"Modal",namespace:"modal",silent:!1,debug:!1,verbose:!1,performance:!0,observeChanges:!1,allowMultiple:!1,detachable:!0,closable:!0,autofocus:!0,inverted:!1,blurring:!1,dimmerSettings:{closable:!1,useCSS:!0},keyboardShortcuts:!0,context:"body",queue:!1,duration:500,offset:0,transition:"scale",padding:50,onShow:function(){},onVisible:function(){},onHide:function(){return!0},onHidden:function(){},onApprove:function(){return!0},onDeny:function(){return!0},selector:{close:"> .close",approve:".actions .positive, .actions .approve, .actions .ok",deny:".actions .negative, .actions .deny, .actions .cancel",modal:".ui.modal"},error:{dimmer:"UI Dimmer, a required component is not included in this page",method:"The method you called is not defined.",notFound:"The element you specified could not be found"},className:{active:"active",animating:"animating",blurring:"blurring",inverted:"inverted",loading:"loading",scrolling:"scrolling",undetached:"undetached"}}}(jQuery,window,document),function(e,t,i,s){"use strict";t="undefined"!=typeof t&&t.Math==Math?t:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e.fn.dimmer=function(t){var n,o=e(this),a=(new Date).getTime(),r=[],l=arguments[0],c="string"==typeof l,d=[].slice.call(arguments,1);return o.each(function(){var h,u,p,f=e.isPlainObject(t)?e.extend(!0,{},e.fn.dimmer.settings,t):e.extend({},e.fn.dimmer.settings),m=f.selector,g=f.namespace,v=f.className,b=f.error,_="."+g,y="module-"+g,w=o.selector||"",C="ontouchstart"in i.documentElement?"touchstart":"click",k=e(this),x=this,D=k.data(y);p={preinitialize:function(){p.is.dimmer()?(u=k.parent(),h=k):(u=k,h=p.has.dimmer()?f.dimmerName?u.find(m.dimmer).filter("."+f.dimmerName):u.find(m.dimmer):p.create(),p.set.variation())},initialize:function(){p.debug("Initializing dimmer",f),p.bind.events(),p.set.dimmable(),p.instantiate()},instantiate:function(){p.verbose("Storing instance of module",p),D=p,k.data(y,D)},destroy:function(){p.verbose("Destroying previous module",h),p.unbind.events(),p.remove.variation(),u.off(_)},bind:{events:function(){f.on=="hover"?u.on("mouseenter"+_,p.show).on("mouseleave"+_,p.hide):f.on=="click"&&u.on(C+_,p.toggle),p.is.page()&&(p.debug("Setting as a page dimmer",u),p.set.pageDimmer()),p.is.closable()&&(p.verbose("Adding dimmer close event",h),u.on(C+_,m.dimmer,p.event.click))}},unbind:{events:function(){k.removeData(y),u.off(_)}},event:{click:function(t){p.verbose("Determining if event occured on dimmer",t),(h.find(t.target).length===0||e(t.target).is(m.content))&&(p.hide(),t.stopImmediatePropagation())}},addContent:function(t){var i=e(t);p.debug("Add content to dimmer",i),i.parent()[0]!==h[0]&&i.detach().appendTo(h)},create:function(){var t=e(f.template.dimmer());return f.dimmerName&&(p.debug("Creating named dimmer",f.dimmerName),t.addClass(f.dimmerName)),t.appendTo(u),t},show:function(t){t=e.isFunction(t)?t:function(){},p.debug("Showing dimmer",h,f),p.is.dimmed()&&!p.is.animating()||!p.is.enabled()?p.debug("Dimmer is already shown or disabled"):(p.animate.show(t),f.onShow.call(x),f.onChange.call(x))},hide:function(t){t=e.isFunction(t)?t:function(){},p.is.dimmed()||p.is.animating()?(p.debug("Hiding dimmer",h),p.animate.hide(t),f.onHide.call(x),f.onChange.call(x)):p.debug("Dimmer is not visible")},toggle:function(){p.verbose("Toggling dimmer visibility",h),p.is.dimmed()?p.hide():p.show()},animate:{show:function(t){t=e.isFunction(t)?t:function(){},f.useCSS&&e.fn.transition!==s&&h.transition("is supported")?(f.opacity!=="auto"&&p.set.opacity(),h.transition({displayType:"flex",animation:f.transition+" in",queue:!1,duration:p.get.duration(),useFailSafe:!0,onStart:function(){p.set.dimmed()},onComplete:function(){p.set.active(),t()}})):(p.verbose("Showing dimmer animation with javascript"),p.set.dimmed(),f.opacity=="auto"&&(f.opacity=.8),h.stop().css({opacity:0,width:"100%",height:"100%"}).fadeTo(p.get.duration(),f.opacity,function(){h.removeAttr("style"),p.set.active(),t()}))},hide:function(t){t=e.isFunction(t)?t:function(){},f.useCSS&&e.fn.transition!==s&&h.transition("is supported")?(p.verbose("Hiding dimmer with css"),h.transition({displayType:"flex",animation:f.transition+" out",queue:!1,duration:p.get.duration(),useFailSafe:!0,onStart:function(){p.remove.dimmed()},onComplete:function(){p.remove.active(),t()}})):(p.verbose("Hiding dimmer with javascript"),p.remove.dimmed(),h.stop().fadeOut(p.get.duration(),function(){p.remove.active(),h.removeAttr("style"),t()}))}},get:{dimmer:function(){return h},duration:function(){return typeof f.duration=="object"?p.is.active()?f.duration.hide:f.duration.show:f.duration}},has:{dimmer:function(){return f.dimmerName?k.find(m.dimmer).filter("."+f.dimmerName).length>0:k.find(m.dimmer).length>0}},is:{active:function(){return h.hasClass(v.active)},animating:function(){return h.is(":animated")||h.hasClass(v.animating)},closable:function(){return f.closable=="auto"?f.on=="hover"?!1:!0:f.closable},dimmer:function(){return k.hasClass(v.dimmer)},dimmable:function(){return k.hasClass(v.dimmable)},dimmed:function(){return u.hasClass(v.dimmed)},disabled:function(){return u.hasClass(v.disabled)},enabled:function(){return!p.is.disabled()},page:function(){return u.is("body")},pageDimmer:function(){return h.hasClass(v.pageDimmer)}},can:{show:function(){return!h.hasClass(v.disabled)}},set:{opacity:function(e){var t=h.css("background-color"),i=t.split(","),s=i&&i.length==3,n=i&&i.length==4;e=f.opacity===0?0:f.opacity||e,s||n?(i[3]=e+")",t=i.join(",")):t="rgba(0, 0, 0, "+e+")",p.debug("Setting opacity to",e),h.css("background-color",t)},active:function(){h.addClass(v.active)},dimmable:function(){u.addClass(v.dimmable)},dimmed:function(){u.addClass(v.dimmed)},pageDimmer:function(){h.addClass(v.pageDimmer)},disabled:function(){h.addClass(v.disabled)},variation:function(e){e=e||f.variation,e&&h.addClass(e)}},remove:{active:function(){h.removeClass(v.active)},dimmed:function(){u.removeClass(v.dimmed)},disabled:function(){h.removeClass(v.disabled)},variation:function(e){e=e||f.variation,e&&h.removeClass(e)}},setting:function(t,i){if(p.debug("Changing setting",t,i),e.isPlainObject(t))e.extend(!0,f,t);else{if(i===s)return f[t];e.isPlainObject(f[t])?e.extend(!0,f[t],i):f[t]=i}},internal:function(t,i){if(e.isPlainObject(t))e.extend(!0,p,t);else{if(i===s)return p[t];p[t]=i}},debug:function(){!f.silent&&f.debug&&(f.performance?p.performance.log(arguments):(p.debug=Function.prototype.bind.call(console.info,console,f.name+":"),p.debug.apply(console,arguments)))},verbose:function(){!f.silent&&f.verbose&&f.debug&&(f.performance?p.performance.log(arguments):(p.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),p.verbose.apply(console,arguments)))},error:function(){f.silent||(p.error=Function.prototype.bind.call(console.error,console,f.name+":"),p.error.apply(console,arguments))},performance:{log:function(e){var t,i,s;f.performance&&(t=(new Date).getTime(),s=a||t,i=t-s,a=t,r.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:x,"Execution Time":i})),clearTimeout(p.performance.timer),p.performance.timer=setTimeout(p.performance.display,500)},display:function(){var t=f.name+":",i=0;a=!1,clearTimeout(p.performance.timer),e.each(r,function(e,t){i+=t["Execution Time"]}),t+=" "+i+"ms",w&&(t+=" '"+w+"'"),o.length>1&&(t+=" ("+o.length+")"),(console.group!==s||console.table!==s)&&r.length>0&&(console.groupCollapsed(t),console.table?console.table(r):e.each(r,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),r=[]}},invoke:function(t,i,o){var a,r,l,c=D;return i=i||d,o=x||o,"string"==typeof t&&c!==s&&(t=t.split(/[\. ]/),a=t.length-1,e.each(t,function(i,n){var o=i!=a?n+t[i+1].charAt(0).toUpperCase()+t[i+1].slice(1):t;if(e.isPlainObject(c[o])&&i!=a)c=c[o];else{if(c[o]!==s)return r=c[o],!1;if(!e.isPlainObject(c[n])||i==a)return c[n]!==s?(r=c[n],!1):(p.error(b.method,t),!1);c=c[n]}})),e.isFunction(r)?l=r.apply(o,i):r!==s&&(l=r),e.isArray(n)?n.push(l):n!==s?n=[n,l]:l!==s&&(n=l),r}},p.preinitialize(),c?(D===s&&p.initialize(),p.invoke(l)):(D!==s&&D.invoke("destroy"),p.initialize())}),n!==s?n:this},e.fn.dimmer.settings={name:"Dimmer",namespace:"dimmer",silent:!1,debug:!1,verbose:!1,performance:!0,dimmerName:!1,variation:!1,closable:"auto",useCSS:!0,transition:"fade",on:!1,opacity:"auto",duration:{show:500,hide:500},onChange:function(){},onShow:function(){},onHide:function(){},error:{method:"The method you called is not defined."},className:{active:"active",animating:"animating",dimmable:"dimmable",dimmed:"dimmed",dimmer:"dimmer",disabled:"disabled",hide:"hide",pageDimmer:"page",show:"show"},selector:{dimmer:"> .ui.dimmer",content:".ui.dimmer > .content, .ui.dimmer > .content > .center"},template:{dimmer:function(){return e("<div />").attr("class","ui dimmer")}}}}(jQuery,window,document),function(){window.user="",window.focus_item=0,window.o=[],$(function(){var e,t,i,s,n,o,a,r,l,c;return t=$("#datepicker-start"),e=$("#datepicker-end"),n={format:"yyyy-mm-dd",todayBtn:!0,autoclose:!0,pickerReferer:"input",pickerPosition:"bottom-left",minView:"month",language:gon.locale,forceParse:!0},a=function(e){var t,i,s;return t=/^(\d{4})-(\d{2})-(\d{2})$/,i=/^(\d{4})(\d{2})(\d{2})$/,t.test(e)?e:i.test(e)?(s=e.match(i),s.slice(1).join("-")):null},$("#search-filter").on("click",function(){var i,s,n,o,r,l;if(r=$.trim(t.val()),s=$.trim(e.val())){if(s=a(s),null===s)return alert(gon.end_time_error),!1;i=new Date(s).getTime()}if(r){if(r=a(r),null===r)return alert(gon.start_time_error),!1;if(o=new Date(r).getTime(),s&&o>i)return alert(gon.start_time_can_not_bigger_than_end),!1}return l=$.trim($("#search-text").val()),n=location.origin+location.pathname+"?",r&&(n+="start_date="+r+"&"),s&&(n+="end_date="+s+"&"),l&&l!==gon.all_users&&(n+="user="+l),window.location.href=n}),$("#tdrop").dropdown(),l=getUrlParameter("start_date"),o=getUrlParameter("end_date"),null!==l&&""!==l&&void 0!==l&&t.val(decodeURIComponent(l)),null!==o&&""!==o&&void 0!==o&&e.val(decodeURIComponent(o)),r=new Date,l&&(s=new Date(l)),o&&(i=new Date(o)),s>i&&(i=new Date(s),i.setDate(i.getDate()+1)),n.initialDate=s||r,t.datetimepicker(n),i&&t.datetimepicker("setEndDate",i),n.initialDate=i||r,e.datetimepicker(n),s&&e.datetimepicker("setStartDate",s),t.on("changeDate",function(t){return s=t.date,e.datetimepicker("setStartDate",s),s>i?(i.setDate(s.getDate()+1),e.datetimepicker("update",i)):void 0}),e.on("changeDate",function(e){return i=e.date,t.datetimepicker("setEndDate",i)}),c=getUrlParameter("user"),null!==c&&""!==c&&void 0!==c&&($("#search-text").val(decodeURIComponent(c)),$("#search-text")),$("#search-text").on("keyup",function(e){var t,i,s,n,o,a;if(e.which===40||e.which===38||e.which===13)return $("#i-user-menu").css("display")!=="none"&&(e.which===40||e.which===38?(e.which===40&&focus_item<window.o.length-1?focus_item++:e.which===38&&focus_item>0&&focus_item--,i=$(".self-bind").eq(focus_item),$("#search-text").val(i.text())):e.which===13&&$(".self-bind").eq(focus_item).trigger("click")),void 0;for(s=$.trim($("#search-text").val().toLowerCase()),window.o=[],$("#i-user").empty(),a=window.user,n=0,o=a.length;o>n;n++)t=a[n],s.length>=1&&t.toLowerCase().indexOf(s)!==-1&&window.o.length<=10&&(window.o.push(t),$("#i-user").append('<div class="item self-bind">'+t+"</div>"),$(".self-bind").on("click",function(){return $("#search-text").val($(this).text()),$("#i-user").empty()}));return window.o.length>=1?($("#i-user-menu").show(),window.focus_item>window.o.length?window.focus_item=0:void 0):($("#i-user-menu").hide(),window.focus_item=0)}),$("#i-user-menu").show(),$(document).on("click",function(){return $("#i-user-menu").hide()})})}.call(this),/*
 * jQuery File Upload Plugin 5.31.6
 * https://github.com/blueimp/jQuery-File-Upload
 *
 * Copyright 2010, Sebastian Tschan
 * https://blueimp.net
 *
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/MIT
 */
function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.xhrFileUpload=!(!window.XMLHttpRequestUpload||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,i){return t=this.messages[t]||t.toString(),i&&e.each(i,function(e,i){t=t.replace("{"+e+"}",i)}),t},formData:function(e){return e.serializeArray()},add:function(t,i){(i.autoUpload||i.autoUpload!==!1&&e(this).fileupload("option","autoUpload"))&&i.process().done(function(){i.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){var e=this.slice||this.webkitSlice||this.mozSlice;return e.apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,i){var s=e-this.timestamp;return(!this.bitrate||!i||s>i)&&(this.bitrate=(t-this.loaded)*(1e3/s)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var i;return typeof t.formData=="function"?t.formData(t.form):e.isArray(t.formData)?t.formData:e.type(t.formData)==="object"?(i=[],e.each(t.formData,function(e,t){i.push({name:e,value:t})}),i):[]},_getTotal:function(t){var i=0;return e.each(t,function(e,t){i+=t.size||1}),i},_initProgressObject:function(t){var i={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,i):t._progress=i},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(e,t){if(e.lengthComputable){var i,s=Date.now?Date.now():(new Date).getTime();if(t._time&&t.progressInterval&&s-t._time<t.progressInterval&&e.loaded!==e.total)return;t._time=s,i=Math.floor(e.loaded/e.total*(t.chunkSize||t._progress.total))+(t.uploadedBytes||0),this._progress.loaded+=i-t._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(s,this._progress.loaded,t.bitrateInterval),t._progress.loaded=t.loaded=i,t._progress.bitrate=t.bitrate=t._bitrateTimer.getBitrate(s,i,t.bitrateInterval),this._trigger("progress",e,t),this._trigger("progressall",e,this._progress)}},_initProgressListener:function(t){var i=this,s=t.xhr?t.xhr():e.ajaxSettings.xhr();s.upload&&(e(s.upload).bind("progress",function(e){var s=e.originalEvent;e.lengthComputable=s.lengthComputable,e.loaded=s.loaded,e.total=s.total,i._onProgress(e,t)}),t.xhr=function(){return s})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var i,s=this,n=t.files[0],o=t.multipart||!e.support.xhrFileUpload,a=t.paramName[0];t.headers=t.headers||{},t.contentRange&&(t.headers["Content-Range"]=t.contentRange),o&&!t.blob&&this._isInstanceOf("File",n)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(n.name)+'"'),o?e.support.xhrFormDataFileUpload&&(t.postMessage?(i=this._getFormData(t),t.blob?i.push({name:a,value:t.blob}):e.each(t.files,function(e,s){i.push({name:t.paramName[e]||a,value:s})})):(s._isInstanceOf("FormData",t.formData)?i=t.formData:(i=new FormData,e.each(this._getFormData(t),function(e,t){i.append(t.name,t.value)})),t.blob?i.append(a,t.blob,n.name):e.each(t.files,function(e,n){(s._isInstanceOf("File",n)||s._isInstanceOf("Blob",n))&&i.append(t.paramName[e]||a,n,n.name)})),t.data=i):(t.contentType=n.type,t.data=t.blob||n),t.blob=null},_initIframeSettings:function(t){var i=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&i&&i!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var i=e(t.fileInput),s=t.paramName;return s?e.isArray(s)||(s=[s]):(s=[],i.each(function(){for(var t=e(this),i=t.prop("name")||"files[]",n=(t.prop("files")||[1]).length;n;)s.push(i),n-=1}),s.length||(s=[i.prop("name")||"files[]"])),s},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||t.form.prop("method")||"").toUpperCase(),t.type!=="POST"&&t.type!=="PUT"&&t.type!=="PATCH"&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var i=e.extend({},this.options,t);return this._initFormSettings(i),this._initDataSettings(i),i},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,i,s){var n=e.Deferred(),o=n.promise();return i=i||this.options.context||o,t===!0?n.resolveWith(i,s):t===!1&&n.rejectWith(i,s),o.abort=n.promise,this._enhancePromise(o)},_addConvenienceMethods:function(t,i){var s=this,n=function(t){return e.Deferred().resolveWith(s,[t]).promise()};i.process=function(e,t){return(e||t)&&(i._processQueue=this._processQueue=(this._processQueue||n(this)).pipe(e,t)),this._processQueue||n(this)},i.submit=function(){return this.state()!=="pending"&&(i.jqXHR=this.jqXHR=s._trigger("submit",t,this)!==!1&&s._onSend(t,this)),this.jqXHR||s._getXHRPromise()},i.abort=function(){return this.jqXHR?this.jqXHR.abort():s._getXHRPromise()},i.state=function(){return this.jqXHR?s._getDeferredState(this.jqXHR):this._processQueue?s._getDeferredState(this._processQueue):void 0},i.progress=function(){return this._progress},i.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),i=t&&t.split("-"),s=i&&i.length>1&&parseInt(i[1],10);return s&&s+1},_chunkedUpload:function(t,i){t.uploadedBytes=t.uploadedBytes||0;var s,n,o=this,a=t.files[0],r=a.size,l=t.uploadedBytes,c=t.maxChunkSize||r,d=this._blobSlice,h=e.Deferred(),u=h.promise();return this._isXHRUpload(t)&&d&&(l||r>c)&&!t.data?i?!0:l>=r?(a.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",a.error])):(n=function(){var i=e.extend({},t),u=i._progress.loaded;i.blob=d.call(a,l,l+c,a.type),i.chunkSize=i.blob.size,i.contentRange="bytes "+l+"-"+(l+i.chunkSize-1)+"/"+r,o._initXHRData(i),o._initProgressListener(i),s=(o._trigger("chunksend",null,i)!==!1&&e.ajax(i)||o._getXHRPromise(!1,i.context)).done(function(s,a,c){l=o._getUploadedBytes(c)||l+i.chunkSize,u+i.chunkSize-i._progress.loaded&&o._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-i.uploadedBytes,total:l-i.uploadedBytes}),i),t.uploadedBytes=i.uploadedBytes=l,i.result=s,i.textStatus=a,i.jqXHR=c,o._trigger("chunkdone",null,i),o._trigger("chunkalways",null,i),r>l?n():h.resolveWith(i.context,[s,a,c])}).fail(function(e,t,s){i.jqXHR=e,i.textStatus=t,i.errorThrown=s,o._trigger("chunkfail",null,i),o._trigger("chunkalways",null,i),h.rejectWith(i.context,[e,t,s])})},this._enhancePromise(u),u.abort=function(){return s.abort()},n(),u):!1},_beforeSend:function(e,t){this._active===0&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,i,s,n){var o=n._progress.total,a=n._response;n._progress.loaded<o&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:o,total:o}),n),a.result=n.result=t,a.textStatus=n.textStatus=i,a.jqXHR=n.jqXHR=s,this._trigger("done",null,n)},_onFail:function(e,t,i,s){var n=s._response;s.recalculateProgress&&(this._progress.loaded-=s._progress.loaded,this._progress.total-=s._progress.total),n.jqXHR=s.jqXHR=e,n.textStatus=s.textStatus=t,n.errorThrown=s.errorThrown=i,this._trigger("fail",null,s)},_onAlways:function(e,t,i,s){this._trigger("always",null,s)},_onSend:function(t,i){i.submit||this._addConvenienceMethods(t,i);var s,n,o,a,r=this,l=r._getAJAXSettings(i),c=function(){return r._sending+=1,l._bitrateTimer=new r._BitrateTimer,s=s||((n||r._trigger("send",t,l)===!1)&&r._getXHRPromise(!1,l.context,n)||r._chunkedUpload(l)||e.ajax(l)).done(function(e,t,i){r._onDone(e,t,i,l)}).fail(function(e,t,i){r._onFail(e,t,i,l)}).always(function(e,t,i){if(r._onAlways(e,t,i,l),r._sending-=1,r._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>r._sending)for(var s=r._slots.shift();s;){if(r._getDeferredState(s)==="pending"){s.resolve();break}s=r._slots.shift()}r._active===0&&r._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(o=e.Deferred(),this._slots.push(o),a=o.pipe(c)):(this._sequence=this._sequence.pipe(c,c),a=this._sequence),a.abort=function(){return n=[void 0,"abort","abort"],s?s.abort():(o&&o.rejectWith(l.context,n),c())},this._enhancePromise(a)):c()},_onAdd:function(t,i){var s,n,o,a,r=this,l=!0,c=e.extend({},this.options,i),d=c.limitMultiFileUploads,h=this._getParamName(c);if((c.singleFileUploads||d)&&this._isXHRUpload(c))if(!c.singleFileUploads&&d)for(o=[],s=[],a=0;a<i.files.length;a+=d)o.push(i.files.slice(a,a+d)),n=h.slice(a,a+d),n.length||(n=h),s.push(n);else s=h;else o=[i.files],s=[h];return i.originalFiles=i.files,e.each(o||i.files,function(n,a){var c=e.extend({},i);return c.files=o?a:[a],c.paramName=s[n],r._initResponseObject(c),r._initProgressObject(c),r._addConvenienceMethods(t,c),l=r._trigger("add",t,c)}),l},_replaceFileInput:function(t){var i=t.clone(!0);e("<form></form>").append(i)[0].reset(),t.after(i).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,s){return s===t[0]?i[0]:s}),t[0]===this.element[0]&&(this.element=i)},_handleFileTreeEntry:function(t,i){var s,n=this,o=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),o.resolve([e])};return i=i||"",t.isFile?t._file?(t._file.relativePath=i,o.resolve(t._file)):t.file(function(e){e.relativePath=i,o.resolve(e)},a):t.isDirectory?(s=t.createReader(),s.readEntries(function(e){n._handleFileTreeEntries(e,i+t.name+"/").done(function(e){o.resolve(e)}).fail(a)},a)):o.resolve([]),o.promise()},_handleFileTreeEntries:function(t,i){var s=this;return e.when.apply(e,e.map(t,function(e){return s._handleFileTreeEntry(e,i)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){t=t||{};var i=t.items;return i&&i.length&&(i[0].webkitGetAsEntry||i[0].getAsEntry)?this._handleFileTreeEntries(e.map(i,function(e){var t;return e.webkitGetAsEntry?(t=e.webkitGetAsEntry(),t&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){t=e(t);var i,s,n=t.prop("webkitEntries")||t.prop("entries");if(n&&n.length)return this._handleFileTreeEntries(n);if(i=e.makeArray(t.prop("files")),i.length)i[0].name===void 0&&i[0].fileName&&e.each(i,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(s=t.prop("value"),!s)return e.Deferred().resolve([]).promise();i=[{name:s.replace(/^.*\\/,"")}]}return e.Deferred().resolve(i).promise()},_getFileInputFiles:function(t){return t instanceof e&&t.length!==1?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var i=this,s={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(s.fileInput).always(function(e){s.files=e,i.options.replaceFileInput&&i._replaceFileInput(s.fileInput),i._trigger("change",t,s)!==!1&&i._onAdd(t,s)})},_onPaste:function(t){var i=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,s={files:[]};return i&&i.length&&(e.each(i,function(e,t){var i=t.getAsFile&&t.getAsFile();i&&s.files.push(i)}),this._trigger("paste",t,s)===!1||this._onAdd(t,s)===!1)?!1:void 0},_onDrop:function(e){e.dataTransfer=e.originalEvent&&e.originalEvent.dataTransfer;var t=this,i=e.dataTransfer,s={};i&&i.files&&i.files.length&&(e.preventDefault(),this._getDroppedFiles(i).always(function(i){s.files=i,t._trigger("drop",e,s)!==!1&&t._onAdd(e,s)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var i=t.dataTransfer;if(i){if(this._trigger("dragover",t)===!1)return!1;e.inArray("Files",i.types)!==-1&&(i.dropEffect="copy",t.preventDefault())}},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,i){var s=e.inArray(t,this._specialOptions)!==-1;s&&this._destroyEventHandlers(),this._super(t,i),s&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;t.fileInput===void 0?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),i=t.pop();return t.shift(),new RegExp(t.join("/"),i)},_isRegExpOption:function(t,i){return"url"!==t&&e.type(i)==="string"&&/^\/.*\/[igm]{0,3}$/.test(i)},_initDataAttributes:function(){var t=this,i=this.options;e.each(e(this.element[0].cloneNode(!1)).data(),function(e,s){t._isRegExpOption(e,s)&&(s=t._getRegExp(s)),i[e]=s})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var i=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,i._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var i,s,n=this,o=e.Deferred(),a=o.promise();return a.abort=function(){return s=!0,i?i.abort():(o.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){s||(t.files=e,i=n._onSend(null,t).then(function(e,t,i){o.resolve(e,t,i)},function(e,t,i){o.reject(e,t,i)}))}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){var t,i={className:"autosizejs",append:"",callback:!1,resizeDelay:10},s='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',n=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],o=e(s).data("autosize",!0)[0];o.style.lineHeight="99px",e(o).css("lineHeight")==="99px"&&n.push("lineHeight"),o.style.lineHeight="",e.fn.autosize=function(s){return s=e.extend({},i,s||{}),o.parentNode!==document.body&&e(document.body).append(o),this.each(function(){function i(){var i,a={};if(t=h,o.className=s.className,l=parseInt(u.css("maxHeight"),10),e.each(n,function(e,t){a[t]=u.css(t)}),e(o).css(a),"oninput"in h){var r=h.style.width;h.style.width="0px",i=h.offsetWidth,h.style.width=r}}function a(){var n,a,r,d;t!==h&&i(),o.value=h.value+s.append,o.style.overflowY=h.style.overflowY,a=parseInt(h.style.height,10),"getComputedStyle"in window?(d=window.getComputedStyle(h),r=h.getBoundingClientRect().width,e.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(e,t){r-=parseInt(d[t],10)}),o.style.width=r+"px"):o.style.width=Math.max(u.width(),0)+"px",o.scrollTop=0,o.scrollTop=9e4,n=o.scrollTop,l&&n>l?(h.style.overflowY="scroll",n=l):(h.style.overflowY="hidden",c>n&&(n=c)),n+=p,a!==n&&(h.style.height=n+"px",f&&s.callback.call(h,h))}function r(){clearTimeout(d),d=setTimeout(function(){u.width()!==g&&a()},parseInt(s.resizeDelay,10))}var l,c,d,h=this,u=e(h),p=0,f=e.isFunction(s.callback),m={height:h.style.height,overflow:h.style.overflow,overflowY:h.style.overflowY,wordWrap:h.style.wordWrap,resize:h.style.resize},g=u.width();u.data("autosize")||(u.data("autosize",!0),(u.css("box-sizing")==="border-box"||u.css("-moz-box-sizing")==="border-box"||u.css("-webkit-box-sizing")==="border-box")&&(p=u.outerHeight()-u.height()),c=Math.max(parseInt(u.css("minHeight"),10)-p||0,u.height()),u.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:u.css("resize")==="none"||u.css("resize")==="vertical"?"none":"horizontal"}),"onpropertychange"in h?"oninput"in h?u.on("input.autosize keyup.autosize",a):u.on("propertychange.autosize",function(){event.propertyName==="value"&&a()}):u.on("input.autosize",a),s.resizeDelay!==!1&&e(window).on("resize.autosize",r),u.on("autosize.resize",a),u.on("autosize.resizeIncludeStyle",function(){t=null,a()}),u.on("autosize.destroy",function(){t=null,clearTimeout(d),e(window).off("resize",r),u.off("autosize").off(".autosize").css(m).removeData("autosize")}),a())})}}(window.jQuery||window.Zepto),/*
  Implement Github like autocomplete mentions
  http://ichord.github.com/At.js

  Copyright (c) 2013 chord.luo@gmail.com
  Licensed under the MIT license.
*/
function(){var e=[].slice;(function(e){return"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)})(function(t){var i,s,n,o,a,r,l,c;return r={DOWN:40,UP:38,ESC:27,TAB:9,ENTER:13},o={before_save:function(e){var i,s,n,o;if(!t.isArray(e))return e;for(o=[],s=0,n=e.length;n>s;s++)i=e[s],t.isPlainObject(i)?o.push(i):o.push({name:i});return o},matcher:function(e,t){var i,s;return e="(?:^|\\s)"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),s=new RegExp(e+"([A-Za-z0-9_+-]*)$|"+e+"([^\\x00-\\xff]*)$","gi"),i=s.exec(t),i?i[2]||i[1]:null},filter:function(e,t,i){var s,n,o,a;for(a=[],n=0,o=t.length;o>n;n++)s=t[n],~s[i].toLowerCase().indexOf(e)&&a.push(s);return a},remote_filter:null,sorter:function(e,t,i){var s,n,o,a;if(!e)return t;for(a=[],n=0,o=t.length;o>n;n++)s=t[n],s.atwho_order=s[i].toLowerCase().indexOf(e),s.atwho_order>-1&&a.push(s);return a.sort(function(e,t){return e.atwho_order-t.atwho_order})},tpl_eval:function(e,t){try{return e.replace(/\$\{([^\}]*)\}/g,function(e,i){return t[i]})}catch(i){return""}},highlighter:function(e,t){var i;return t?(i=new RegExp(">\\s*(\\w*)("+t.replace("+","\\+")+")(\\w*)\\s*<","ig"),e.replace(i,function(e,t,i,s){return"> "+t+"<strong>"+i+"</strong>"+s+" <"})):e},before_insert:function(e){return e}},l=function(){function e(e,t){this.context=e,this.key=t}var i;return i={},e.prototype.saved=function(){return this.fetch()>0},e.prototype.query=function(e,t){var i,s,n;return i=this.fetch(),s=this.context.get_opt("search_key"),t(i=this.context.callbacks("filter").call(this.context,e,i,s)),i&&i.length>0?void 0:(n=this.context.callbacks("remote_filter"))!=null?n.call(this.context,e,t):void 0},e.prototype.fetch=function(){return i[this.key]||[]},e.prototype.save=function(e){return i[this.key]=this.context.callbacks("before_save").call(this.context,e||[])},e.prototype.load=function(e){return!this.saved()&&e?this._load(e):void 0},e.prototype.reload=function(e){return this._load(e)},e.prototype._load=function(e){var i=this;return"string"==typeof e?t.ajax(e,{dataType:"json"}).done(function(e){return i.save(e)}):this.save(e)},e}(),n=function(){function s(e){this.id=e.id||n(),this.settings={},this.pos=0,this.current_flag=null,this.query=null,this.the_flag={},this._views={},this._models={},this.$inputor=t(e),i.append(this.$el=t("<div id='atwho-ground-"+this.id+"'></div>")),this.listen()}var n,a;return a=0,n=function(){return a+=1},s.prototype.listen=function(){var e=this;return this.$inputor.on("keyup.atwho",function(t){return e.on_keyup(t)}).on("keydown.atwho",function(t){return e.on_keydown(t)}).on("scroll.atwho",function(){var t;return(t=e.view)!=null?t.hide():void 0}).on("blur.atwho",function(){var t;return(t=e.view)!=null?t.hide(e.get_opt("display_timeout")):void 0})},s.prototype.set_context_for=function(e){return e=this.current_flag=this.the_flag[e],this.view=this._views[e],this.model=this._models[e],this},s.prototype.reg=function(e,i){var s;return s=this.settings[e]=t.extend({},this.settings[e]||t.fn.atwho["default"],i),this.set_context_for((s.alias?this.the_flag[s.alias]=e:void 0,e=this.the_flag[e]=e)),(this._models[e]=new l(this,e)).reload(s.data),this._views[e]=new c(this,e),this},s.prototype.trigger=function(e,t){var i,s;return t.push(this),i=this.get_opt("alias"),s=i?""+e+"-"+i+".atwho":""+e+".atwho",this.$inputor.trigger(s,t)},s.prototype.super_call=function(){var i,s;s=arguments[0],i=2<=arguments.length?e.call(arguments,1):[];try{return o[s].apply(this,i)}catch(n){return t.error(""+n+" Or maybe At.js doesn't have function "+s)}},s.prototype.callbacks=function(e){return this.get_opt("callbacks")[e]||o[e]},s.prototype.get_opt=function(e){try{return this.settings[this.current_flag][e]}catch(t){return null}},s.prototype.rect=function(){var e,t;return e=this.$inputor.caret("offset",this.pos-1),t=document.selection?0:2,{left:e.left,top:e.top,bottom:e.top+e.height+t}},s.prototype.catch_query=function(){var e,i,s,n,o,a,r,l=this;return i=this.$inputor.val(),e=this.$inputor.caret("pos"),a=i.slice(0,e),n=null,t.map(this.settings,function(e){var t;return t=l.callbacks("matcher").call(l,e.at,a),null!=t?(n=t,l.set_context_for(e.at)):void 0}),"string"==typeof n&&n.length<=this.get_opt("max_len",20)?(o=e-n.length,s=o+n.length,this.pos=o,n={text:n.toLowerCase(),head_pos:o,end_pos:s},this.trigger("matched",[this.current_flag,n.text])):(r=this.view)!=null&&r.hide(),this.query=n},s.prototype.insert=function(e){var t,i,s,n,o;return t=this.$inputor,e=""+e,s=t.val(),i=this.get_opt("display_flag")?0:this.current_flag.length,n=s.slice(0,(this.query.head_pos||0)-i),o=""+n+e+" "+s.slice(this.query.end_pos||0),t.val(o),t.caret("pos",n.length+e.length+1),t.change()},s.prototype.on_keyup=function(e){switch(e.keyCode){case r.ESC:e.preventDefault(),this.view.hide();break;case r.DOWN:case r.UP:t.noop();break;default:this.look_up()}},s.prototype.on_keydown=function(e){var i;if((i=this.view)!=null?i.visible():void 0)switch(e.keyCode){case r.ESC:e.preventDefault(),this.view.hide();break;case r.UP:e.preventDefault(),this.view.prev();break;case r.DOWN:e.preventDefault(),this.view.next();break;case r.TAB:case r.ENTER:if(!this.view.visible())return;e.preventDefault(),this.view.choose();break;default:t.noop()}},s.prototype.render_view=function(e){var t;return t=this.get_opt("search_key"),e=this.callbacks("sorter").call(this,this.query.text,e.slice(0,1001),t),this.view.render(e.slice(0,this.get_opt("limit")))},s.prototype.look_up=function(){var e,i;if(e=this.catch_query())return i=function(e){return e&&e.length>0?this.render_view(e):this.view.hide()},this.model.query(e.text,t.proxy(i,this))},s}(),c=function(){function e(e,i){this.context=e,this.key=i,this.id=this.context.get_opt("alias")||"at-view-"+this.key.charCodeAt(0),this.$el=t("<div id='"+this.id+"' class='atwho-view'><ul id='"+this.id+"-ul' class='atwho-view-url'></ul></div>"),this.timeout_id=null,this.context.$el.append(this.$el),this.bind_event()}return e.prototype.bind_event=function(){var e,i=this;return e=this.$el.find("ul"),e.on("mouseenter.view","li",function(i){return e.find(".cur").removeClass("cur"),t(i.currentTarget).addClass("cur")}).on("click",function(e){return i.choose(),e.preventDefault()})},e.prototype.visible=function(){return this.$el.is(":visible")},e.prototype.choose=function(){var e;return e=this.$el.find(".cur"),this.context.insert(this.context.callbacks("before_insert").call(this.context,e.data("value"),e)),this.context.trigger("inserted",[e]),this.hide()},e.prototype.reposition=function(){var e,i;return i=this.context.rect(),i.bottom+this.$el.height()-t(window).scrollTop()>t(window).height()&&(i.bottom=i.top-this.$el.height()),e={left:i.left,top:i.bottom},this.$el.offset(e),this.context.trigger("reposition",[e])},e.prototype.next=function(){var e,t;return e=this.$el.find(".cur").removeClass("cur"),t=e.next(),t.length||(t=this.$el.find("li:first")),t.addClass("cur")},e.prototype.prev=function(){var e,t;return e=this.$el.find(".cur").removeClass("cur"),t=e.prev(),t.length||(t=this.$el.find("li:last")),t.addClass("cur")},e.prototype.show=function(){return this.visible()||this.$el.show(),this.reposition()},e.prototype.hide=function(e){var t,i=this;return isNaN(e&&this.visible())?this.$el.hide():(t=function(){return i.hide()},clearTimeout(this.timeout_id),this.timeout_id=setTimeout(t,e))},e.prototype.render=function(e){var i,s,n,o,r,l,c;if(!t.isArray(e||e.length<=0))return this.hide(),void 0;for(this.$el.find("ul").empty(),s=this.$el.find("ul"),r=this.context.get_opt("tpl",a),l=0,c=e.length;c>l;l++)n=e[l],o=this.context.callbacks("tpl_eval").call(this.context,r,n),i=t(this.context.callbacks("highlighter").call(this.context,o,this.context.query.text)),i.data("atwho-info",n),s.append(i);return this.show(),s.find("li:first").addClass("cur")},e}(),a="<li data-value='${name}'>${name}</li>",s={init:function(e){var i,s;return s=(i=t(this)).data("atwho"),s||i.data("atwho",s=new n(this)),s.reg(e.at,e)},load:function(e,t){return this.set_context_for(e),this.model.load(t)},run:function(){return this.look_up()}},i=t("<div id='atwho-container'></div>"),t.fn.atwho=function(e){var n;return n=arguments,t("body").append(i),this.filter("textarea, input").each(function(){var i;return"object"!=typeof e&&e?s[e]?(i=t(this).data("atwho"))?s[e].apply(i,Array.prototype.slice.call(n,1)):void 0:t.error("Method "+e+" does not exist on jQuery.caret"):s.init.apply(this,n)})},t.fn.atwho["default"]={at:void 0,alias:void 0,data:null,tpl:a,callbacks:o,search_key:"name",limit:5,max_len:20,display_flag:!0,display_timeout:300}})}.call(this),/*
  Implement Github like autocomplete mentions
  http://ichord.github.com/At.js

  Copyright (c) 2013 chord.luo@gmail.com
  Licensed under the MIT license.
*/
function(){(function(e){return"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)})(function(e){"use strict";var t,i,s,n;return n="caret",t=function(){function t(e){this.$inputor=e,this.domInputor=this.$inputor[0]}return t.prototype.getPos=function(){var e,t,i,s,n,o,a,r,l;return i=this.domInputor,i.focus(),document.selection?(a=document.selection.createRange(),o=0,a&&a.parentElement()===i&&(n=i.value.replace(/\r\n/g,"\n"),s=n.length,l=i.createTextRange(),l.moveToBookmark(a.getBookmark()),t=i.createTextRange(),t.collapse(!1),l.compareEndPoints("StartToEnd",t)>-1?r=e=s:(r=-l.moveStart("character",-s),e=-l.moveEnd("character",-s)))):r=i.selectionStart,r},t.prototype.setPos=function(e){var t,i;return t=this.domInputor,document.selection?(i=t.createTextRange(),i.move("character",e),i.select()):t.setSelectionRange(e,e)},t.prototype.getPosition=function(e){var t,s,n,o,a,r,l,c,d;return t=this.$inputor,n=function(e){return e.replace(/</g,"&lt").replace(/>/g,"&gt").replace(/`/g,"&#96").replace(/"/g,"&quot").replace(/\r\n|\r|\n/g,"<br />")},e=e||this.getPos(),l=t.val().slice(0,e),a="<span>"+n(l)+"</span>",a+="<span id='caret'>|</span>",r=new i(t),s=r.create(a).rect(),c=s.left-t.scrollLeft(),d=s.top-t.scrollTop(),o=s.height,{left:c,top:d,height:o}},t.prototype.getOffset=function(t){var i,s,n,o,a,r,l;return i=this.$inputor,document.selection?(a=this.domInputor.createTextRange(),t&&a.move("character",t),r=a.boundingLeft+i.scrollLeft(),l=a.boundingTop+e(window).scrollTop()+i.scrollTop(),s=a.boundingHeight):(n=i.offset(),o=this.getPosition(t),r=n.left+o.left,l=n.top+o.top,s=o.height),{left:r,top:l,height:s}},t}(),i=function(){function t(e){this.$inputor=e}return t.prototype.css_attr=["overflowY","height","width","paddingTop","paddingLeft","paddingRight","paddingBottom","marginTop","marginLeft","marginRight","marginBottom","fontFamily","borderStyle","borderWidth","wordWrap","fontSize","lineHeight","overflowX","text-align"],t.prototype.mirrorCss=function(){var t,i=this;return t={position:"absolute",left:-9999,top:0,zIndex:-2e4,"white-space":"pre-wrap"},e.each(this.css_attr,function(e,s){return t[s]=i.$inputor.css(s)}),t},t.prototype.create=function(t){return this.$mirror=e("<div></div>"),this.$mirror.css(this.mirrorCss()),this.$mirror.html(t),this.$inputor.after(this.$mirror),this},t.prototype.rect=function(){var e,t,i;return e=this.$mirror.find("#caret"),t=e.position(),i={left:t.left,top:t.top,height:e.height()},this.$mirror.remove(),i},t}(),s={pos:function(e){return e?this.setPos(e):this.getPos()},position:function(e){return this.getPosition(e)},offset:function(e){return this.getOffset(e)}},e.fn.caret=function(i){var n;return n=new t(this),s[i]?s[i].apply(n,Array.prototype.slice.call(arguments,1)):e.error("Method "+i+" does not exist on jQuery.caret")}})}.call(this),function(){var e;(e=window.GitLab)==null&&(window.GitLab={}),GitLab.GfmAutoComplete={dataSource:"",loadedSource:"",loadedSourceData:null,enableLinkIssue:!0,Emoji:{assetBase:"",template:'<li data-value="${insert}">${name} <img alt="${name}" height="20" src="${image}" width="20" /></li>'},Members:{template:'<li data-value="${name}">${name} <small>${username}</small></li>'},Issues:{template:'<li data-value="${id}"><small>#${id}</small> ${title} </li>'},PullRequests:{template:'<li data-value="${id}"><small>!${id}</small> ${title} </li>'},Code:{template:'<li data-value="${id}"><small>!${id}</small> ${title} </li>'},reload:function(){var e,t,i;return e=this.loadedSourceData,t=$(".md-input, .edit_note textarea"),i=this.updateMembers(),t.atwho("load","@",i),this.enableLinkIssue&&t.atwho("load","issues",e.issues),t.atwho("load","pull_requests",e.pull_requests),t.atwho("load",":",e.emojis)},updateMembers:function(){var e,t,i,s,n,o,a,r,l,c,d,h,u,p,f,m,g,v,b,_;for(s=this.loadedSourceData,o=[],$("#notes-list .note a.avatar, #issue-meta a.author").each(function(){return o.push({username:$(this).attr("username"),name:$(this).attr("name")})}),i=[],a=0,d=o.length;d>a;a++){for(t=o[a],n=!1,r=0,h=i.length;h>r;r++)e=i[r],e.username===t.username&&(n=!0);n||i.push(t)}for(b=s.members,l=0,u=b.length;u>l;l++){for(t=b[l],n=!1,c=0,p=i.length;p>c;c++)e=i[c],e.username===t.username&&(n=!0);n||i.push(t)}for(this.membersNickname={},_=s.members,g=0,f=_.length;f>g;g++)t=_[g],this.membersNickname[t.nickname]=t.username;for(this.Members.data={},v=0,m=i.length;m>v;v++)t=i[v],this.Members.data[t.name]=t.username;return i},reloadMembers:function(){var e,t;return e=$(".md-input, .edit_note textarea"),t=this.updateMembers(),e.atwho("load","@",t)},setup:function(){var e,t,i,s,n,o=this;return n=this,s=$(".md-input, .edit_note textarea"),s.atwho({at:":",tpl:this.Emoji.template,callbacks:{before_save:function(e){return $.map(e,function(e){return{name:e,insert:e+":",image:""+o.Emoji.assetBase+"/"+e+".png"}})}}}),s.atwho({at:"@",tpl:this.Members.template,search_key:"search",callbacks:{before_save:function(e){var t,i;return i={},t=$.map(e,function(e){return i[e.name]=e.username,{name:e.name,username:e.username,search:""+e.username+" "+e.name}}),s.data("users",i),t}}}),this.enableLinkIssue&&s.atwho({at:"#",alias:"issues",search_key:"search",tpl:this.Issues.template,callbacks:{before_save:function(e){return $.map(e,function(e){return{id:e.ident,title:htmlSafe(e.title),search:""+e.ident+" "+e.title}})}}}),s.atwho({at:"!",alias:"pull_requests",search_key:"search",tpl:this.PullRequests.template,callbacks:{before_save:function(e){return $.map(e,function(e){return{id:e.iid,title:htmlSafe(e.title),search:""+e.iid+" "+e.title}})}}}),s.atwho({at:"&",alias:"codes",search_key:"search",tpl:this.Code.template,callbacks:{before_save:function(e){return $.map(e,function(e){return{id:e.id,key:htmlSafe(e.key),search:""+e.id+" "+e.key}})}}}),i=function(){var e,t;return e=$(document.activeElement),t=e.prop("selectionStart"),t>0?e.val().charAt(t-1):""},e=function(e){var s,o,a,r,l;if(o=!1,n.dataSource){for(l=[i(),String.fromCharCode(e.charCode)],a=0,r=l.length;r>a;a++)if(s=l[a],["@","#","!",":","&"].indexOf(s)>=0){o=!0;break}return o?t():null}},t=function(){return n.dataSource!==n.loadedSource?(n.loadedSource=n.dataSource,$.getJSON(n.dataSource).done(function(e){return n.loadedSourceData=e,n.reload(),$(document.activeElement).atwho("run"),s.off(".checkload")})):n.loadedSourceData?n.reload():void 0},s.on("keypress.checkload",e),s.on("keydown.checkload",e),s.bind("paste.checkload",t),s.bind("reply.checkload",t)}}}.call(this),function(){this.Notes={init:function(){return Notes.setupMainTargetNoteForm(),Notes.addClassForPreLine(),$(document).on("click",".js-add-diff-note-button",Notes.addDiffNote),$(document).on("click",".js-discussion-reply-button",Notes.replyToDiscussionNote),$(document).on("click",".js-close-discussion-note-form",Notes.closeNoteForm),$(document).on("click",".js-note-edit",Notes.editNote),$(document).on("click",".js-note-reply",Notes.replyNote),$(document).on("click",".js-note-delete",Notes.removeNote),$(document).on("click",".js-main-target-form .js-comment-button",Notes.disableMainTargetForm),$(document).on("ajax:complete",".js-main-target-form",Notes.resetMainTargetForm),$(document).on("click",".js-show-outdated-discussion",function(e){return $(this).next(".outdated-discussion").show(),e.preventDefault()}),$(document).on("click",".js-comment-button",function(){var e;return e=$(this).closest("form"),$(".except-editor-textarea").length===0&&Notes.replaceUserName(e),Notes.SetCommentedCodeLine()})},replaceUserName:function(e){var t,i,s,n,o;if(t=e.find("textarea.md-input"),t.length===0&&(t=$("#editor_comment")),n=t.data("users"),i=t.val(),!jQuery.isEmptyObject(n)){o={},Object.keys(n).forEach(function(e){return o[e]=n[e]});for(s in o)Notes.resetKey(o,s,"@"+s);Object.keys(o).map(function(e){return o[e]="@"+o[e]}),i=Notes.replaceAllName(i,o)}return t.val(i)},SetCommentedCodeLine:function(){var e;return e=$(this).closest("tr").prev().addClass("has-comments"),$(".has-comments").attr("title"," Diff "),$(".has-comments").on("click",function(){$(this).next().next().transition("horizontal flip")})},disableMainTargetForm:function(){return $(".js-comment-button").addClass("disabled"),$("#comment-loadder #loadding-state").addClass("active").removeClass("disabled")},initCommentForm:function(e){var t,i,s;return i=e.find(".js-comment-text"),i.autosize(),s=function(i){return e.find(".js-drag-drop > .text").hide(),e.find(".js-drag-drop > .uploading").hide(),e.find(".js-drag-drop > .error").text(i).show(),setTimeout(t,3e3)},t=function(){return e.find(".js-drag-drop > .error").hide(),e.find(".js-drag-drop > .text").show()}},setupMainTargetNoteForm:function(){var e;return e=$(".js-new-note-form"),Notes.setupNoteForm(e)},addClassForPreLine:function(){return $(".class-for-pre-line").closest("tr").prev().addClass("has-comments"),$(".has-comments").attr("title",""),$(".has-comments").on("click",function(e){$(e.target).parent().is(".has-comments")&&($(this).next().is(".js-temp-notes-holder")&&$(this).next().next().transition("horizontal flip"),$(this).next().transition("horizontal flip"))})},setupNoteForm:function(e){return disableButtonIfEmptyField(e.find(".js-comment-text"),e.find(".js-comment-button")),e.removeClass("js-new-note-form"),Notes.initCommentForm(e.find(".js-comment-form")),e.find(".js-comment-text").on("keydown",function(e){return(e.metaKey||e.ctrlKey)&&e.keyCode===13&&$(this).val()!==""?$(e.target).closest("form").submit():void 0}),e.find("#note_noteable_type").val()!=="Commit"&&e.find(".js-notify-commit-author").remove(),GitLab.GfmAutoComplete.setup(),e.show()},setupCloneNoteForm:function(e,t){var i;return i=e.find(".js-comment-button"),e.find(".js-comment-text").focus(),e.find("textarea").val(""),t.on("keyup",function(){t.val().length>0?(i.removeClass("disabled"),i.removeAttr("disabled")):(i.addClass("disabled"),i.attr("disabled","disabled"))}),i.addClass("disabled"),i.attr("disabled","disabled"),e.on("submit",function(){return $.trim(e.find("textarea").val()).length===0?(alert("!"),!1):(i.addClass("disabled"),i.attr("disabled","disabled"),e.find(".js-close-discussion-note-form").addClass("disabled"),e.find(".js-close-discussion-note-form").attr("disabled","disabled"),e.find("textarea").prop("readonly",!0))})},setupDiscussionNoteForm:function(e,t){return t.find("form").attr("rel",e.data("discussionId")),t.find("#note_commit_id").val(e.data("commitId")),t.find("#note_line_code").val(e.data("lineCode")),t.find("#note_noteable_type").val(e.data("noteableType")),t.find("#note_noteable_id").val(e.data("noteableId")),Notes.setupNoteForm(t)},closeNoteForm:function(){var e,t,i;return t=$(this).closest("form"),e=t.parents(".form-with-gravatar"),e.prev(".js-discussion-reply-button").css("display","inline-block"),t.prev(".note-content").show(),i=t.closest("tr"),i.is(".js-temp-notes-holder")?i.remove():(e.remove(),t.remove())},editNote:function(e){var t,i,s,n;return e.preventDefault(),t=$(this).parents(".comment"),t.data("loading")?void 0:(n=t.closest(".note"),s=n.find(".edit_note"),s.length>0?(s.find(".write-content").addClass("focused"),s.find(".md-input").focus(),void 0):(i=t.find(".ui.dimmer").addClass("active"),t.data("loading",!0),$.get($(this).attr("href"),function(e){return n.find(".note-content").hide(),$(e).insertAfter(n.find(".note-content")),s=n.find(".edit_note"),Notes.setupNoteForm(s),Notes.resetMainTargetForm,t.data("loading",!1),i.removeClass("active")})))},replyNote:function(){var e,t,i,s,n,o;return t=$(".common-note-form textarea.md-input"),t.length===0&&(t=$("#editor_comment")),o=t.data("users"),o||(o={}),i=$(this).attr("name"),n=$(this).attr("username"),i||(e=$(this).parents(".comment.note").find("a[name]"),i=e.attr("name"),n=e.attr("username")),o[i]=n,s=t.val()+"@"+i+" ",t.data("users",o),t.val(s)},setCount:function(e,t){var i,s;return i=e.parent().parent().find(".notes_line").find(".count"),s=parseInt($.trim(i.text())),t?s++:s--,i.text(s)},setTotalCount:function(e){var t;return t=$.trim($("#total_count").text()),t=parseInt(t),e?t++:t--,$("#total_count").text(t)},removeNote:function(e){var t,i,s,n;return e.preventDefault(),n=$(this),s=$(e.target).attr("href"),void 0===s&&(s=$(e.target).parent().attr("href")),confirm("?")?(t=$(e.target).parents(".comment.note"),i=t.find(".ui.dimmer").addClass("active"),$.ajax({url:s,beforeSend:function(e){e.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))},type:"DELETE",success:function(){var e,t;return e=n.closest(".note"),t=e.closest(".notes"),t.find(".note").length===1&&(t.closest(".discussion").remove(),t.closest("tr").remove()),Notes.setCount(t,!1),Notes.setTotalCount(!1),e.remove(),Notes.updateVotes()},error:function(){return alert(","),i.removeClass("acitve")}})):void 0},resetMainTargetForm:function(){var e;return e=$(this),e.find(".js-errors").remove(),e.find(".js-comment-text").val("").trigger("input")},appendNewNote:function(e,t){return $(".common-note-form .md-input").removeAttr("disabled").val(""),$("#loadding-state").removeClass("active").addClass("disabled"),$("#notes-list").append(t),Notes.updateVotes(),$("[name='note[note]']").val("")},appendNewDiscussionNote:function(e,t,i){var s,n,o;return s=e.split("-")[3],$(".notes[rel='"+e+"']").length===0?(o=$("input[value='"+s+"']"),o.parent().parent().parent().parent().parent().after(t),o.parent().parent().parent().parent().remove(),Notes.setTotalCount(!0),$(".js-temp-notes-holder").remove(),void 0):($(".js-temp-notes-holder").remove(),n=$(".notes[rel='"+e+"']"),n.append(i),n.parent().find(".form-with-gravatar").find(".js-close-discussion-note-form").click(),n.find(".comment.note:last").addClass("diff_note"),Notes.setCount(n,!0),Notes.setTotalCount(!0))},replyToDiscussionNote:function(){var e,t;return $(".js-temp-notes-holder").remove(),$(".new-reply-note").remove(),$(".js-discussion-reply-button").show(),t=$(".form-with-gravatar").last(),$(this).hide(),e=t.clone(),e.find(".js-comment-form").remove(),e.find(".js-close-discussion-note-form").css("display","inline-block"),e.find("#note_noteable_type").after("<textarea class='editor_comment' id='editor_comment' name='note[note]'></textarea>"),e.addClass("new-reply-note"),$(this).parent().append(e),$(".editor_comment").markdown({language:"zh",imgurl:"/upload",base64url:"/upload_with_base_64"}),Notes.dragFrom(e),Notes.setupDiscussionNoteForm($(this),$(this).parent().find(".common-note-form")),Notes.setupCloneNoteForm(e,e.find(".md-input"))},addDiffNote:function(e){var t,i,s,n;return e.preventDefault(),$(".js-temp-notes-holder").remove(),$(".new-reply-note").remove(),$(".js-discussion-reply-button").css("display","inline-block"),i=$(".form-with-gravatar").last(),n=$(this).closest("tr"),s=n.next(),s.is(".js-temp-notes-holder")?void 0:(s.is(".notes_holder")&&Notes.replyToDiscussionNote,n.after('<tr class="notes_holder js-temp-notes-holder"><td class="notes_line" colspan="2"></td><td class="notes_content"></td></tr>'),t=i.clone(),t.find(".js-close-discussion-note-form").css("display","inline-block"),t.find(".js-comment-form").remove(),t.find("#note_noteable_type").after("<textarea class='editor_diff' id='editor_diff' name='note[note]'></textarea>"),n.next().find(".notes_content").append(t),$(".editor_diff").markdown({language:"zh",imgurl:"/upload",base64url:"/upload_with_base_64"}),t.find(".md-input").val(""),Notes.dragFrom(t),Notes.setupDiscussionNoteForm($(this),n.next().find(".common-note-form")),Notes.setupCloneNoteForm(t,t.find(".md-input")))},updateVotes:function(){var e,t,i,s,n,o,a;return o=$("#votes .votes"),i=$("#notes-list .note .vote"),o.size()?(s=i.filter(".upvote").size(),e=i.filter(".downvote").size(),a=s+e,n=a?100/a*s:0,t=a?100-n:0,o.find(".bar-success").css("width",n+"%"),o.find(".bar-danger").css("width",t+"%"),o.find(".upvotes").text(o.find(".upvotes").text().replace(/\d+/,s)),o.find(".downvotes").text(o.find(".downvotes").text().replace(/\d+/,e))):void 0},dragFrom:function(e){return e.find(".md-input").bind("drop",function(t){var i,s,n,o;if(t.preventDefault(),t.stopPropagation(),s=t.originalEvent.dataTransfer.files,s.length!==0){if(s[0].type.indexOf("text")!==-1)return s[0].size>102400?(alert("100k"),void 0):(n=new FileReader,n.onload=function(t){var i,s,n;return s=t.target.result,n=e.find(".md-input").val(),e.find(".md-input").val(n+s),i=jQuery.Event("keyup",{which:39}),e.find(".md-input").trigger(i)},n.readAsText(s[0]),!1);if(s[0].type.indexOf("image")===-1)return alert(""),void 0;$.browser.safari?img.src=window.webkitURL.createObjectURL(s[0]):$.browser.mozilla?img.src=window.URL.createObjectURL(s[0]):(n=new FileReader,n.onload=function(){e.find(".md-input").parents().eq(3).find(".small.loader").show()},n.readAsDataURL(s[0])),o=new XMLHttpRequest,o.open("post","/upload",!0),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.upload.addEventListener("progress",function(e){var t;e.lengthComputable&&(t=Math.ceil(e.loaded/e.total*100))},!1),o.addEventListener("load",function(t){var i,s,n;e.find(".md-input").parents().eq(3).find(".small.loader").hide(),s=$.parseJSON(t.target.response),n=e.find(".md-input").val(),n+="![]("+s.files[0].url+' "")',e.find(".md-input").val(n),i=jQuery.Event("keyup",{which:39}),e.find(".md-input").trigger(i)},!1),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content")),o.setRequestHeader("X-Requested-With","XMLHttpRequest"),i=new FormData,i.append("files",s[0]),o.send(i)}})},replaceAllName:function(e,t){var i,s;return i=Object.keys(t).map(function(e){return e=e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),"("+e+" )|("+e+"$)"}),s=new RegExp(i.join("|"),"g"),e.replace(s,function(e){return t[e.trim()]+" "})},resetKey:function(e,t,i){var s;return s=e[t],e[i]=s,delete e[t]}}}.call(this),/**
 * Endless Scroll plugin for jQuery
 *
 * v1.4.8
 *
 * Copyright (c) 2008 Fred Wu
 *
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
function(e){e.fn.endlessScroll=function(t){var i,s={bottomPixels:50,fireOnce:!0,fireDelay:150,loader:"<br />Loading...<br />",data:"",insertAfter:"div:last",resetCounter:function(){return!1},callback:function(){return!0},ceaseFire:function(){return!1}},t=e.extend({},s,t),n=!0,o=!1,a=0;t.ceaseFire.apply(this)===!0&&(n=!1),n===!0&&e(this).scroll(function(){if(t.ceaseFire.apply(this)===!0)return n=!1,void 0;if(this==document||this==window)i=e(document).height()-e(window).height()<=e(window).scrollTop()+t.bottomPixels;else{var s=e(".endless_scroll_inner_wrap",this);s.length==0&&(s=e(this).wrapInner('<div class="endless_scroll_inner_wrap" />').find(".endless_scroll_inner_wrap")),i=s.length>0&&s.height()-e(this).height()<=e(this).scrollTop()+t.bottomPixels}i&&(t.fireOnce==0||t.fireOnce==1&&1!=o)&&(t.resetCounter.apply(this)===!0&&(a=0),o=!0,a++,e(t.insertAfter).after('<div id="endless_scroll_loader">'+t.loader+"</div>"),data=typeof t.data=="function"?t.data.apply(this,[a]):t.data,data!==!1&&(e(t.insertAfter).after('<div id="endless_scroll_data">'+data+"</div>"),e("#endless_scroll_data").hide().fadeIn(250,function(){e(this).removeAttr("id")}),t.callback.apply(this,[a]),t.fireDelay!==!1||t.fireDelay!==0?(e("body").after('<div id="endless_scroll_marker"></div>'),e("#endless_scroll_marker").fadeTo(t.fireDelay,1,function(){e(this).remove(),o=!1})):o=!1),e("#endless_scroll_loader").remove())})}}(jQuery),function(){var t;t=function(){function t(){}return t.data={ref:null,limit:0,offset:0,loading:!1},t.disable=!1,t.showProgress=function(){return $(".loading").show()},t.hideProgress=function(){return $(".loading").hide()},t.init=function(t,i){return $(".day-commits-table li.commit").on("click",function(t){return t.target.nodeName!=="A"?(location.href=$(this).attr("url"),e.stopPropagation(),!1):void 0}),this.data.ref=t,this.data.limit=i,this.data.offset=i,this.initLoadMore(),this.showProgress()},t.getOld=function(){var e;return e=this,e.data.loading?void 0:(e.showProgress(),e.data.loading=!0,$.ajax({type:"GET",url:location.href,data:this.data,complete:function(){return e.hideProgress(),e.data.loading=!1},dataType:"script"}))},t.append=function(e,t){return $("#commits-list").append(t),e>0?this.data.offset+=e:this.disable=!0},t.initLoadMore=function(){var e=this;return $(document).endlessScroll({bottomPixels:400,fireDelay:1e3,fireOnce:!0,ceaseFire:function(){return e.disable},callback:function(){return e.getOld()}})},t}(),this.CommitsList=t}.call(this),function(){window.Projects=function(){return $(".new_project, .edit_project").on("ajax:before",function(){var e,t;if(e=$(this).attr("id")==="transfer_form",t=$(this).attr("id")==="transfer_to_enterprise_form")return $(".transfer-enp-loading").show();if(e){if($.trim($("#transfer_form .select2-choice span").text())==="")return;return $(".transfer-project-loader").show(),$(".ajax-users-dropdown .select2-input").attr("disabled","disabled").addClass("disabled")}return $(".project_new_holder, .project_edit_holder").hide(),$(".save-project-loader").show()}),disableButtonIfEmptyField("#project_name",".project-submit")},$(function(){var e;return $(".project-refs-select").on("change",function(){return $(this).parents("form").submit()}),$("#project_issues_enabled").change(function(){return $(this).is(":checked")===!0?$("#project_issues_tracker").removeAttr("disabled"):$("#project_issues_tracker").attr("disabled","disabled"),$("#project_issues_tracker").change()}),$(".star-container").on("ajax:success",function(e,t){return $(".star-container .social-count").html(t.data.count),$(".star-container").toggleClass("stared"),t.data.type==="star"?$("#checked_comments_with_star").hide():t.data.type==="unstar"?$("#checked_comments_with_star").show():void 0}),$(".watch-container").on("ajax:success",function(e,t){return $(".watch-container .social-count").html(t.count),$(".watch-container").toggleClass("watched")}),$("input[id='private']").click(function(){return $("input[id='private']").attr("checked")==="checked"?$("div .clearfix[id='language']").hide(500):$("div .clearfix[id='language']").show(500)}),$("div .clearfix#select_app").hide(0),$("input[id='paas']").click(function(){return $("input[id='paas']").attr("checked")==="checked"?$("div .clearfix#select_app").show(500):$("div .clearfix#select_app").hide(500)}),$("div .detail_sonar#sonar_detail_form").hide(0),e=$("#sonar_detail_form"),$("a#sonar_detail").click(function(){return $("#sonar_detail_modal").modal("show")}),$("#sonar_cancel").click(function(){return $("#sonar_detail_modal").modal("hide")}),$("#btn_utest_detail").click(function(){return $("#utest_detail_modal").modal("show")}),$("#utest_cancel").click(function(){return $("#utest_detail_modal").modal("hide")}),$("#btn_codesafe_detail").click(function(){return $("#codesafe_detail_modal").modal("show")}),$("#codesafe_cancel").click(function(){return $("#codesafe_detail_modal").modal("hide")})})}.call(this),/* =========================================================
 * bootstrap-datetimepicker.js
 * =========================================================
 * Copyright 2012 Stefan Petre
 *
 * Improvements by Andrew Rowls
 * Improvements by Sbastien Malot
 * Improvements by Yun Lai
 * Improvements by Kenneth Henderick
 * Improvements by CuGBabyBeaR
 * Improvements by Christian Vaas <auspex@auspex.eu>
 *
 * Project URL : http://www.malot.fr/bootstrap-datetimepicker
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */
function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?e(require("jquery")):e(jQuery)}(function(e,t){function i(){return new Date(Date.UTC.apply(Date,arguments))}"indexOf"in Array.prototype||(Array.prototype.indexOf=function(e,i){i===t&&(i=0),0>i&&(i+=this.length),0>i&&(i=0);for(var s=this.length;s>i;i++)if(i in this&&this[i]===e)return i;return-1});var s=function(i,s){var n=this;this.element=e(i),this.container=s.container||"body",this.language=s.language||this.element.data("date-language")||"en",this.language=this.language in o?this.language:this.language.split("-")[0],this.language=this.language in o?this.language:"en",this.isRTL=o[this.language].rtl||!1,this.formatType=s.formatType||this.element.data("format-type")||"standard",this.format=a.parseFormat(s.format||this.element.data("date-format")||o[this.language].format||a.getDefaultFormat(this.formatType,"input"),this.formatType),this.isInline=!1,this.isVisible=!1,this.isInput=this.element.is("input"),this.fontAwesome=s.fontAwesome||this.element.data("font-awesome")||!0,this.bootcssVer=s.bootcssVer||(this.isInput?this.element.is(".form-control")?3:2:this.bootcssVer=this.element.is(".input-group")?3:2),this.component=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-th, .input-group-addon .glyphicon-time, .input-group-addon .glyphicon-remove, .input-group-addon .glyphicon-calendar, .input-group-addon .fa-calendar, .input-group-addon .fa-clock-o").parent():this.element.find(".add-on .icon-th, .add-on .icon-time, .add-on .icon-calendar, .add-on .fa-calendar, .add-on .fa-clock-o").parent():!1,this.componentReset=this.element.is(".date")?this.bootcssVer==3?this.element.find(".input-group-addon .glyphicon-remove, .input-group-addon .fa-times").parent():this.element.find(".add-on .icon-remove, .add-on .fa-times").parent():!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&this.component.length===0&&(this.component=!1),this.linkField=s.linkField||this.element.data("link-field")||!1,this.linkFormat=a.parseFormat(s.linkFormat||this.element.data("link-format")||a.getDefaultFormat(this.formatType,"link"),this.formatType),this.minuteStep=s.minuteStep||this.element.data("minute-step")||5,this.pickerPosition=s.pickerPosition||this.element.data("picker-position")||"bottom-right",this.showMeridian=s.showMeridian||this.element.data("show-meridian")||!1,this.initialDate=s.initialDate||new Date,this.zIndex=s.zIndex||this.element.data("z-index")||t,this.title=typeof s.title=="undefined"?!1:s.title,this.defaultTimeZone=null,this.timezone=s.timezone||this.defaultTimeZone,this.fontAwesome?(this.icontype="fa",this.icons={leftArrow:"fa-chevron-left",rightArrow:"fa-chevron-right"}):(this.icontype="glyphicon",this.icons={leftArrow:"arrow left icon",rightArrow:"arrow right icon"}),this._attachEvents(),this.clickedOutside=function(t){e(t.target).closest(".datetimepicker").length===0&&n.hide()},this.formatViewType="datetime","formatViewType"in s?this.formatViewType=s.formatViewType:"formatViewType"in this.element.data()&&(this.formatViewType=this.element.data("formatViewType")),this.minView=0,"minView"in s?this.minView=s.minView:"minView"in this.element.data()&&(this.minView=this.element.data("min-view")),this.minView=a.convertViewMode(this.minView),this.maxView=a.modes.length-1,"maxView"in s?this.maxView=s.maxView:"maxView"in this.element.data()&&(this.maxView=this.element.data("max-view")),this.maxView=a.convertViewMode(this.maxView),this.wheelViewModeNavigation=!1,"wheelViewModeNavigation"in s?this.wheelViewModeNavigation=s.wheelViewModeNavigation:"wheelViewModeNavigation"in this.element.data()&&(this.wheelViewModeNavigation=this.element.data("view-mode-wheel-navigation")),this.wheelViewModeNavigationInverseDirection=!1,"wheelViewModeNavigationInverseDirection"in s?this.wheelViewModeNavigationInverseDirection=s.wheelViewModeNavigationInverseDirection:"wheelViewModeNavigationInverseDirection"in this.element.data()&&(this.wheelViewModeNavigationInverseDirection=this.element.data("view-mode-wheel-navigation-inverse-dir")),this.wheelViewModeNavigationDelay=100,"wheelViewModeNavigationDelay"in s?this.wheelViewModeNavigationDelay=s.wheelViewModeNavigationDelay:"wheelViewModeNavigationDelay"in this.element.data()&&(this.wheelViewModeNavigationDelay=this.element.data("view-mode-wheel-navigation-delay")),this.startViewMode=2,"startView"in s?this.startViewMode=s.startView:"startView"in this.element.data()&&(this.startViewMode=this.element.data("start-view")),this.startViewMode=a.convertViewMode(this.startViewMode),this.viewMode=this.startViewMode,this.viewSelect=this.minView,"viewSelect"in s?this.viewSelect=s.viewSelect:"viewSelect"in this.element.data()&&(this.viewSelect=this.element.data("view-select")),this.viewSelect=a.convertViewMode(this.viewSelect),this.forceParse=!0,"forceParse"in s?this.forceParse=s.forceParse:"dateForceParse"in this.element.data()&&(this.forceParse=this.element.data("date-force-parse"));for(var r=this.bootcssVer===3?a.templateV3:a.template;r.indexOf("{iconType}")!==-1;)r=r.replace("{iconType}",this.icontype);for(;r.indexOf("{leftArrow}")!==-1;)r=r.replace("{leftArrow}",this.icons.leftArrow);for(;r.indexOf("{rightArrow}")!==-1;)r=r.replace("{rightArrow}",this.icons.rightArrow);if(this.picker=e(r).appendTo(this.isInline?this.element:this.container).on({click:e.proxy(this.click,this),mousedown:e.proxy(this.mousedown,this)}),this.wheelViewModeNavigation&&(e.fn.mousewheel?this.picker.on({mousewheel:e.proxy(this.mousewheel,this)}):console.log("Mouse Wheel event is not supported. Please include the jQuery Mouse Wheel plugin before enabling this option")),this.isInline?this.picker.addClass("datetimepicker-inline"):this.picker.addClass("datetimepicker-dropdown-"+this.pickerPosition+" dropdown-menu"),this.isRTL){this.picker.addClass("datetimepicker-rtl");var l=this.bootcssVer===3?".prev span, .next span":".prev i, .next i";this.picker.find(l).toggleClass(this.icons.leftArrow+" "+this.icons.rightArrow)}e(document).on("mousedown",this.clickedOutside),this.autoclose=!1,"autoclose"in s?this.autoclose=s.autoclose:"dateAutoclose"in this.element.data()&&(this.autoclose=this.element.data("date-autoclose")),this.keyboardNavigation=!0,"keyboardNavigation"in s?this.keyboardNavigation=s.keyboardNavigation:"dateKeyboardNavigation"in this.element.data()&&(this.keyboardNavigation=this.element.data("date-keyboard-navigation")),this.todayBtn=s.todayBtn||this.element.data("date-today-btn")||!1,this.clearBtn=s.clearBtn||this.element.data("date-clear-btn")||!1,this.todayHighlight=s.todayHighlight||this.element.data("date-today-highlight")||!1,this.weekStart=(s.weekStart||this.element.data("date-weekstart")||o[this.language].weekStart||0)%7,this.weekEnd=(this.weekStart+6)%7,this.startDate=-1/0,this.endDate=1/0,this.datesDisabled=[],this.daysOfWeekDisabled=[],this.setStartDate(s.startDate||this.element.data("date-startdate")),this.setEndDate(s.endDate||this.element.data("date-enddate")),this.setDatesDisabled(s.datesDisabled||this.element.data("date-dates-disabled")),this.setDaysOfWeekDisabled(s.daysOfWeekDisabled||this.element.data("date-days-of-week-disabled")),this.setMinutesDisabled(s.minutesDisabled||this.element.data("date-minute-disabled")),this.setHoursDisabled(s.hoursDisabled||this.element.data("date-hour-disabled")),this.fillDow(),this.fillMonths(),this.update(),this.showMode(),this.isInline&&this.show()};s.prototype={constructor:s,_events:[],_attachEvents:function(){this._detachEvents(),this.isInput?this._events=[[this.element,{click:e.proxy(this.show,this),focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?(this._events=[[this.element.find("input"),{click:e.proxy(this.show,this),focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]],this.componentReset&&this._events.push([this.componentReset,{click:e.proxy(this.reset,this)}])):this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]];for(var t,i,s=0;s<this._events.length;s++)t=this._events[s][0],i=this._events[s][1],t.on(i)},_detachEvents:function(){for(var e,t,i=0;i<this._events.length;i++)e=this._events[i][0],t=this._events[i][1],e.off(t);this._events=[]},show:function(t){this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.forceParse&&this.update(),this.place(),e(window).on("resize",e.proxy(this.place,this)),t&&(t.stopPropagation(),t.preventDefault()),this.isVisible=!0,this.element.trigger({type:"show",date:this.date})},hide:function(){this.isVisible&&(this.isInline||(this.picker.hide(),e(window).off("resize",this.place),this.viewMode=this.startViewMode,this.showMode(),this.isInput||e(document).off("mousedown",this.hide),this.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this.isVisible=!1,this.element.trigger({type:"hide",date:this.date})))},remove:function(){this._detachEvents(),e(document).off("mousedown",this.clickedOutside),this.picker.remove(),delete this.picker,delete this.element.data().datetimepicker},getDate:function(){var e=this.getUTCDate();return new Date(e.getTime()+e.getTimezoneOffset()*6e4)},getUTCDate:function(){return this.date},getInitialDate:function(){return this.initialDate},setInitialDate:function(e){this.initialDate=e},setDate:function(e){this.setUTCDate(new Date(e.getTime()-e.getTimezoneOffset()*6e4))},setUTCDate:function(e){e>=this.startDate&&e<=this.endDate?(this.date=e,this.setValue(),this.viewDate=this.date,this.fill()):this.element.trigger({type:"outOfRange",date:e,startDate:this.startDate,endDate:this.endDate})},setFormat:function(e){this.format=a.parseFormat(e,this.formatType);var t;this.isInput?t=this.element:this.component&&(t=this.element.find("input")),t&&t.val()&&this.setValue()},setValue:function(){var t=this.getFormattedDate();this.isInput?this.element.val(t):(this.component&&this.element.find("input").val(t),this.element.data("date",t)),this.linkField&&e("#"+this.linkField).val(this.getFormattedDate(this.linkFormat))},getFormattedDate:function(e){return e==t&&(e=this.format),a.formatDate(this.date,e,this.language,this.formatType,this.timezone)},setStartDate:function(e){this.startDate=e||-1/0,this.startDate!==-1/0&&(this.startDate=a.parseDate(this.startDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setEndDate:function(e){this.endDate=e||1/0,this.endDate!==1/0&&(this.endDate=a.parseDate(this.endDate,this.format,this.language,this.formatType,this.timezone)),this.update(),this.updateNavArrows()},setDatesDisabled:function(t){this.datesDisabled=t||[],e.isArray(this.datesDisabled)||(this.datesDisabled=this.datesDisabled.split(/,\s*/)),this.datesDisabled=e.map(this.datesDisabled,function(e){return a.parseDate(e,this.format,this.language,this.formatType,this.timezone).toDateString()}),this.update(),this.updateNavArrows()},setTitle:function(e,t){return this.picker.find(e).find("th:eq(1)").text(this.title===!1?t:this.title)},setDaysOfWeekDisabled:function(t){this.daysOfWeekDisabled=t||[],e.isArray(this.daysOfWeekDisabled)||(this.daysOfWeekDisabled=this.daysOfWeekDisabled.split(/,\s*/)),this.daysOfWeekDisabled=e.map(this.daysOfWeekDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setMinutesDisabled:function(t){this.minutesDisabled=t||[],e.isArray(this.minutesDisabled)||(this.minutesDisabled=this.minutesDisabled.split(/,\s*/)),this.minutesDisabled=e.map(this.minutesDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},setHoursDisabled:function(t){this.hoursDisabled=t||[],e.isArray(this.hoursDisabled)||(this.hoursDisabled=this.hoursDisabled.split(/,\s*/)),this.hoursDisabled=e.map(this.hoursDisabled,function(e){return parseInt(e,10)}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){if(!this.zIndex){var t=0;e("div").each(function(){var i=parseInt(e(this).css("zIndex"),10);i>t&&(t=i)}),this.zIndex=t+10}var i,s,n,o;o=this.container instanceof e?this.container.offset():e(this.container).offset(),this.component?(i=this.component.offset(),n=i.left,(this.pickerPosition=="bottom-left"||this.pickerPosition=="top-left")&&(n+=this.component.outerWidth()-this.picker.outerWidth())):(i=this.element.offset(),n=i.left,(this.pickerPosition=="bottom-left"||this.pickerPosition=="top-left")&&(n+=this.element.outerWidth()-this.picker.outerWidth()));var a=document.body.clientWidth||window.innerWidth;n+220>a&&(n=a-220),s=this.pickerPosition=="top-left"||this.pickerPosition=="top-right"?i.top-this.picker.outerHeight():i.top+this.height,s-=o.top,n-=o.left,this.picker.css({top:s,left:n,zIndex:this.zIndex})}},update:function(){var e,t=!1;arguments&&arguments.length&&(typeof arguments[0]=="string"||arguments[0]instanceof Date)?(e=arguments[0],t=!0):(e=(this.isInput?this.element.val():this.element.find("input").val())||this.element.data("date")||this.initialDate,("string"==typeof e||e instanceof String)&&(e=e.replace(/^\s+|\s+$/g,""))),e||(e=new Date,t=!1),this.date=a.parseDate(e,this.format,this.language,this.formatType,this.timezone),t&&this.setValue(),this.viewDate=this.date<this.startDate?new Date(this.startDate):this.date>this.endDate?new Date(this.endDate):new Date(this.date),this.fill()},fillDow:function(){for(var e=this.weekStart,t="<tr>";e<this.weekStart+7;)t+='<th class="dow">'+o[this.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datetimepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+o[this.language].monthsShort[t++]+"</span>";this.picker.find(".datetimepicker-months td").html(e)},fill:function(){if(this.date!=null&&this.viewDate!=null){var t=new Date(this.viewDate),s=t.getUTCFullYear(),n=t.getUTCMonth(),r=t.getUTCDate(),l=t.getUTCHours(),c=t.getUTCMinutes(),d=this.startDate!==-1/0?this.startDate.getUTCFullYear():-1/0,h=this.startDate!==-1/0?this.startDate.getUTCMonth():-1/0,u=this.endDate!==1/0?this.endDate.getUTCFullYear():1/0,p=this.endDate!==1/0?this.endDate.getUTCMonth()+1:1/0,f=new i(this.date.getUTCFullYear(),this.date.getUTCMonth(),this.date.getUTCDate()).valueOf(),m=new Date;if(this.setTitle(".datetimepicker-days",o[this.language].months[n]+" "+s),this.formatViewType=="time"){var g=this.getFormattedDate();this.setTitle(".datetimepicker-hours",g),this.setTitle(".datetimepicker-minutes",g)}else this.setTitle(".datetimepicker-hours",r+" "+o[this.language].months[n]+" "+s),this.setTitle(".datetimepicker-minutes",r+" "+o[this.language].months[n]+" "+s);this.picker.find("tfoot th.today").text(o[this.language].today||o.en.today).toggle(this.todayBtn!==!1),this.picker.find("tfoot th.clear").text(o[this.language].clear||o.en.clear).toggle(this.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var v=i(s,n-1,28,0,0,0,0),b=a.getDaysInMonth(v.getUTCFullYear(),v.getUTCMonth());v.setUTCDate(b),v.setUTCDate(b-(v.getUTCDay()-this.weekStart+7)%7);var _=new Date(v);_.setUTCDate(_.getUTCDate()+42),_=_.valueOf();for(var y,w=[];v.valueOf()<_;)v.getUTCDay()==this.weekStart&&w.push("<tr>"),y="",v.getUTCFullYear()<s||v.getUTCFullYear()==s&&v.getUTCMonth()<n?y+=" old":(v.getUTCFullYear()>s||v.getUTCFullYear()==s&&v.getUTCMonth()>n)&&(y+=" new"),this.todayHighlight&&v.getUTCFullYear()==m.getFullYear()&&v.getUTCMonth()==m.getMonth()&&v.getUTCDate()==m.getDate()&&(y+=" today"),v.valueOf()==f&&(y+=" active"),(v.valueOf()+864e5<=this.startDate||v.valueOf()>this.endDate||e.inArray(v.getUTCDay(),this.daysOfWeekDisabled)!==-1||e.inArray(v.toDateString(),this.datesDisabled)!==-1)&&(y+=" disabled"),w.push('<td class="day'+y+'">'+v.getUTCDate()+"</td>"),v.getUTCDay()==this.weekEnd&&w.push("</tr>"),v.setUTCDate(v.getUTCDate()+1);this.picker.find(".datetimepicker-days tbody").empty().append(w.join("")),w=[];for(var C="",k="",x="",D=this.hoursDisabled||[],T=0;24>T;T++)if(D.indexOf(T)===-1){var S=i(s,n,r,T);y="",S.valueOf()+36e5<=this.startDate||S.valueOf()>this.endDate?y+=" disabled":l==T&&(y+=" active"),this.showMeridian&&o[this.language].meridiem.length==2?(k=12>T?o[this.language].meridiem[0]:o[this.language].meridiem[1],k!=x&&(""!=x&&w.push("</fieldset>"),w.push('<fieldset class="hour"><legend>'+k.toUpperCase()+"</legend>")),x=k,C=T%12?T%12:12,w.push('<span class="hour'+y+" hour_"+(12>T?"am":"pm")+'">'+C+"</span>"),23==T&&w.push("</fieldset>")):(C=T+":00",w.push('<span class="hour'+y+'">'+C+"</span>"))}this.picker.find(".datetimepicker-hours td").html(w.join("")),w=[],C="",k="",x="";for(var $=this.minutesDisabled||[],T=0;60>T;T+=this.minuteStep)if($.indexOf(T)===-1){var S=i(s,n,r,l,T,0);y="",S.valueOf()<this.startDate||S.valueOf()>this.endDate?y+=" disabled":Math.floor(c/this.minuteStep)==Math.floor(T/this.minuteStep)&&(y+=" active"),this.showMeridian&&o[this.language].meridiem.length==2?(k=12>l?o[this.language].meridiem[0]:o[this.language].meridiem[1],k!=x&&(""!=x&&w.push("</fieldset>"),w.push('<fieldset class="minute"><legend>'+k.toUpperCase()+"</legend>")),x=k,C=l%12?l%12:12,w.push('<span class="minute'+y+'">'+C+":"+(10>T?"0"+T:T)+"</span>"),59==T&&w.push("</fieldset>")):(C=T+":00",w.push('<span class="minute'+y+'">'+l+":"+(10>T?"0"+T:T)+"</span>"))}this.picker.find(".datetimepicker-minutes td").html(w.join(""));var M=this.date.getUTCFullYear(),j=this.setTitle(".datetimepicker-months",s).end().find("span").removeClass("active");if(M==s){var F=j.length-12;j.eq(this.date.getUTCMonth()+F).addClass("active")}(d>s||s>u)&&j.addClass("disabled"),s==d&&j.slice(0,h).addClass("disabled"),s==u&&j.slice(p).addClass("disabled"),w="",s=parseInt(s/10,10)*10;var U=this.setTitle(".datetimepicker-years",s+"-"+(s+9)).end().find("td");s-=1;for(var T=-1;11>T;T++)w+='<span class="year'+(-1==T||10==T?" old":"")+(M==s?" active":"")+(d>s||s>u?" disabled":"")+'">'+s+"</span>",s+=1;U.html(w),this.place()}},updateNavArrows:function(){var e=new Date(this.viewDate),t=e.getUTCFullYear(),i=e.getUTCMonth(),s=e.getUTCDate(),n=e.getUTCHours();switch(this.viewMode){case 0:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&s<=this.startDate.getUTCDate()&&n<=this.startDate.getUTCHours()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&s>=this.endDate.getUTCDate()&&n>=this.endDate.getUTCHours()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()&&s<=this.startDate.getUTCDate()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()&&s>=this.endDate.getUTCDate()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 2:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()&&i<=this.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()&&i>=this.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 3:case 4:this.startDate!==-1/0&&t<=this.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.endDate!==1/0&&t>=this.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}},mousewheel:function(t){if(t.preventDefault(),t.stopPropagation(),!this.wheelPause){this.wheelPause=!0;var i=t.originalEvent,s=i.wheelDelta,n=s>0?1:0===s?0:-1;this.wheelViewModeNavigationInverseDirection&&(n=-n),this.showMode(n),setTimeout(e.proxy(function(){this.wheelPause=!1},this),this.wheelViewModeNavigationDelay)}},click:function(t){t.stopPropagation(),t.preventDefault();var s=e(t.target).closest("span, td, th, legend");if(s.is("."+this.icontype)&&(s=e(s).parent().closest("span, td, th, legend")),s.length==1){if(s.is(".disabled"))return this.element.trigger({type:"outOfRange",date:this.viewDate,startDate:this.startDate,endDate:this.endDate}),void 0;switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"switch":this.showMode(1);break;case"prev":case"next":var n=a.modes[this.viewMode].navStep*(s[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveHour(this.viewDate,n);break;case 1:this.viewDate=this.moveDate(this.viewDate,n);break;case 2:this.viewDate=this.moveMonth(this.viewDate,n);break;case 3:case 4:this.viewDate=this.moveYear(this.viewDate,n)}this.fill(),this.element.trigger({type:s[0].className+":"+this.convertViewModeText(this.viewMode),date:this.viewDate,startDate:this.startDate,endDate:this.endDate});break;case"clear":this.reset(),this.autoclose&&this.hide();break;case"today":var o=new Date;o=i(o.getFullYear(),o.getMonth(),o.getDate(),o.getHours(),o.getMinutes(),o.getSeconds(),0),o<this.startDate?o=this.startDate:o>this.endDate&&(o=this.endDate),this.viewMode=this.startViewMode,this.showMode(0),this._setDate(o),this.fill(),this.autoclose&&this.hide()}break;case"span":if(!s.is(".disabled")){var r=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),c=this.viewDate.getUTCDate(),d=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();if(s.is(".month")?(this.viewDate.setUTCDate(1),l=s.parent().find("span").index(s),c=this.viewDate.getUTCDate(),this.viewDate.setUTCMonth(l),this.element.trigger({type:"changeMonth",date:this.viewDate}),this.viewSelect>=3&&this._setDate(i(r,l,c,d,h,u,0))):s.is(".year")?(this.viewDate.setUTCDate(1),r=parseInt(s.text(),10)||0,this.viewDate.setUTCFullYear(r),this.element.trigger({type:"changeYear",date:this.viewDate}),this.viewSelect>=4&&this._setDate(i(r,l,c,d,h,u,0))):s.is(".hour")?(d=parseInt(s.text(),10)||0,(s.hasClass("hour_am")||s.hasClass("hour_pm"))&&(12==d&&s.hasClass("hour_am")?d=0:12!=d&&s.hasClass("hour_pm")&&(d+=12)),this.viewDate.setUTCHours(d),this.element.trigger({type:"changeHour",date:this.viewDate}),this.viewSelect>=1&&this._setDate(i(r,l,c,d,h,u,0))):s.is(".minute")&&(h=parseInt(s.text().substr(s.text().indexOf(":")+1),10)||0,this.viewDate.setUTCMinutes(h),this.element.trigger({type:"changeMinute",date:this.viewDate}),this.viewSelect>=0&&this._setDate(i(r,l,c,d,h,u,0))),this.viewMode!=0){var p=this.viewMode;this.showMode(-1),this.fill(),p==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide()}break;case"td":if(s.is(".day")&&!s.is(".disabled")){var c=parseInt(s.text(),10)||1,r=this.viewDate.getUTCFullYear(),l=this.viewDate.getUTCMonth(),d=this.viewDate.getUTCHours(),h=this.viewDate.getUTCMinutes(),u=this.viewDate.getUTCSeconds();s.is(".old")?0===l?(l=11,r-=1):l-=1:s.is(".new")&&(11==l?(l=0,r+=1):l+=1),this.viewDate.setUTCFullYear(r),this.viewDate.setUTCMonth(l,c),this.element.trigger({type:"changeDay",date:this.viewDate}),this.viewSelect>=2&&this._setDate(i(r,l,c,d,h,u,0))}var p=this.viewMode;this.showMode(-1),this.fill(),p==this.viewMode&&this.autoclose&&this.hide()}}},_setDate:function(e,t){t&&"date"!=t||(this.date=e),t&&"view"!=t||(this.viewDate=e),this.fill(),this.setValue();var i;this.isInput?i=this.element:this.component&&(i=this.element.find("input")),i&&(i.change(),this.autoclose&&(!t||"date"==t)),this.element.trigger({type:"changeDate",date:this.getDate()}),null==e&&(this.date=this.viewDate)},moveMinute:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCMinutes(i.getUTCMinutes()+t*this.minuteStep),i},moveHour:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCHours(i.getUTCHours()+t),i},moveDate:function(e,t){if(!t)return e;var i=new Date(e.valueOf());return i.setUTCDate(i.getUTCDate()+t),i},moveMonth:function(e,t){if(!t)return e;var i,s,n=new Date(e.valueOf()),o=n.getUTCDate(),a=n.getUTCMonth(),r=Math.abs(t);if(t=t>0?1:-1,1==r)s=-1==t?function(){return n.getUTCMonth()==a}:function(){return n.getUTCMonth()!=i},i=a+t,n.setUTCMonth(i),(0>i||i>11)&&(i=(i+12)%12);else{for(var l=0;r>l;l++)n=this.moveMonth(n,t);i=n.getUTCMonth(),n.setUTCDate(o),s=function(){return i!=n.getUTCMonth()}}for(;s();)n.setUTCDate(--o),n.setUTCMonth(i);return n},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.startDate&&e<=this.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return e.keyCode==27&&this.show(),void 0;var t,i,s,n=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.keyboardNavigation)break;t=e.keyCode==37?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),s=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),s=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,t),s=this.moveDate(this.viewDate,t)):1==viewMode?(i=this.moveHour(this.date,t),s=this.moveHour(this.viewDate,t)):0==viewMode&&(i=this.moveMinute(this.date,t),s=this.moveMinute(this.viewDate,t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=s,this.setValue(),this.update(),e.preventDefault(),n=!0);break;case 38:case 40:if(!this.keyboardNavigation)break;t=e.keyCode==38?-1:1,viewMode=this.viewMode,e.ctrlKey?viewMode+=2:e.shiftKey&&(viewMode+=1),4==viewMode?(i=this.moveYear(this.date,t),s=this.moveYear(this.viewDate,t)):3==viewMode?(i=this.moveMonth(this.date,t),s=this.moveMonth(this.viewDate,t)):2==viewMode?(i=this.moveDate(this.date,7*t),s=this.moveDate(this.viewDate,7*t)):1==viewMode?this.showMeridian?(i=this.moveHour(this.date,6*t),s=this.moveHour(this.viewDate,6*t)):(i=this.moveHour(this.date,4*t),s=this.moveHour(this.viewDate,4*t)):0==viewMode&&(i=this.moveMinute(this.date,4*t),s=this.moveMinute(this.viewDate,4*t)),this.dateWithinRange(i)&&(this.date=i,this.viewDate=s,this.setValue(),this.update(),e.preventDefault(),n=!0);break;case 13:if(this.viewMode!=0){var o=this.viewMode;this.showMode(-1),this.fill(),o==this.viewMode&&this.autoclose&&this.hide()}else this.fill(),this.autoclose&&this.hide();e.preventDefault();break;case 9:this.hide()}if(n){var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change(),this.element.trigger({type:"changeDate",date:this.getDate()})}},showMode:function(e){if(e){var t=Math.max(0,Math.min(a.modes.length-1,this.viewMode+e));t>=this.minView&&t<=this.maxView&&(this.element.trigger({type:"changeMode",date:this.viewDate,oldViewMode:this.viewMode,newViewMode:t}),this.viewMode=t)}this.picker.find(">div").hide().filter(".datetimepicker-"+a.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()},reset:function(){this._setDate(null,"date")},convertViewModeText:function(e){switch(e){case 4:return"decade";case 3:return"year";case 2:return"month";case 1:return"day";case 0:return"hour"}}};var n=e.fn.datetimepicker;e.fn.datetimepicker=function(i){var n=Array.apply(null,arguments);n.shift();var o;return this.each(function(){var a=e(this),r=a.data("datetimepicker"),l="object"==typeof i&&i;return r||a.data("datetimepicker",r=new s(this,e.extend({},e.fn.datetimepicker.defaults,l))),"string"==typeof i&&typeof r[i]=="function"&&(o=r[i].apply(r,n),o!==t)?!1:void 0}),o!==t?o:this},e.fn.datetimepicker.defaults={},e.fn.datetimepicker.Constructor=s;var o=e.fn.datetimepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],meridiem:["am","pm"],suffix:["st","nd","rd","th"],today:"Today",clear:"Clear"}},a={modes:[{clsName:"minutes",navFnc:"Hours",navStep:1},{clsName:"hours",navFnc:"Date",navStep:1},{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return 0===e%4&&0!==e%100||0===e%400},getDaysInMonth:function(e,t){return[31,a.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},getDefaultFormat:function(e,t){if("standard"==e)return"input"==t?"yyyy-mm-dd hh:ii":"yyyy-mm-dd hh:ii:ss";if("php"==e)return"input"==t?"Y-m-d H:i":"Y-m-d H:i:s";throw new Error("Invalid format type.")},validParts:function(e){if("standard"==e)return/t|hh?|HH?|p|P|z|Z|ii?|ss?|dd?|DD?|mm?|MM?|yy(?:yy)?/g;if("php"==e)return/[dDjlNwzFmMnStyYaABgGhHis]/g;throw new Error("Invalid format type.")},nonpunctuation:/[^ -\/:-@\[-`{-~\t\n\rTZ]+/g,parseFormat:function(e,t){var i=e.replace(this.validParts(t),"\0").split("\0"),s=e.match(this.validParts(t));if(!i||!i.length||!s||s.length==0)throw new Error("Invalid date format.");return{separators:i,parts:s}},parseDate:function(t,n,a,r,l){if(t instanceof Date){var c=new Date(t.valueOf()-t.getTimezoneOffset()*6e4);return c.setMilliseconds(0),c}if(/^\d{4}\-\d{1,2}\-\d{1,2}$/.test(t)&&(n=this.parseFormat("yyyy-mm-dd",r)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}$/.test(t)&&(n=this.parseFormat("yyyy-mm-dd hh:ii",r)),/^\d{4}\-\d{1,2}\-\d{1,2}[T ]\d{1,2}\:\d{1,2}\:\d{1,2}[Z]{0,1}$/.test(t)&&(n=this.parseFormat("yyyy-mm-dd hh:ii:ss",r)),/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(t)){var d,h,u=/([-+]\d+)([dmwy])/,p=t.match(/([-+]\d+)([dmwy])/g);t=new Date;for(var f=0;f<p.length;f++)switch(d=u.exec(p[f]),h=parseInt(d[1]),d[2]){case"d":t.setUTCDate(t.getUTCDate()+h);break;case"m":t=s.prototype.moveMonth.call(s.prototype,t,h);break;case"w":t.setUTCDate(t.getUTCDate()+7*h);break;case"y":t=s.prototype.moveYear.call(s.prototype,t,h)}return i(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),0)}var m,g,d,p=t&&t.toString().match(this.nonpunctuation)||[],t=new Date(0,0,0,0,0,0,0),v={},b=["hh","h","ii","i","ss","s","yyyy","yy","M","MM","m","mm","D","DD","d","dd","H","HH","p","P","z","Z"],_={hh:function(e,t){return e.setUTCHours(t)},h:function(e,t){return e.setUTCHours(t)},HH:function(e,t){return e.setUTCHours(12==t?0:t)},H:function(e,t){return e.setUTCHours(12==t?0:t)},ii:function(e,t){return e.setUTCMinutes(t)},i:function(e,t){return e.setUTCMinutes(t)},ss:function(e,t){return e.setUTCSeconds(t)},s:function(e,t){return e.setUTCSeconds(t)},yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;){if(isNaN(e.getUTCMonth()))return e;e.setUTCDate(e.getUTCDate()-1)}return e},d:function(e,t){return e.setUTCDate(t)},p:function(e,t){return e.setUTCHours(1==t?e.getUTCHours()+12:e.getUTCHours())},z:function(){return l}};if(_.M=_.MM=_.mm=_.m,_.dd=_.d,_.P=_.p,_.Z=_.z,t=i(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds()),p.length==n.parts.length){for(var f=0,y=n.parts.length;y>f;f++){if(m=parseInt(p[f],10),d=n.parts[f],isNaN(m))switch(d){case"MM":g=e(o[a].months).filter(function(){var e=this.slice(0,p[f].length),t=p[f].slice(0,e.length);return e==t}),m=e.inArray(g[0],o[a].months)+1;break;case"M":g=e(o[a].monthsShort).filter(function(){var e=this.slice(0,p[f].length),t=p[f].slice(0,e.length);return e.toLowerCase()==t.toLowerCase()}),m=e.inArray(g[0],o[a].monthsShort)+1;break;case"p":case"P":m=e.inArray(p[f].toLowerCase(),o[a].meridiem);break;case"z":case"Z":}v[d]=m}for(var w,f=0;f<b.length;f++)w=b[f],w in v&&!isNaN(v[w])&&_[w](t,v[w])}return t},formatDate:function(t,i,s,n,r){if(null==t)return"";var l;if("standard"==n)l={t:t.getTime(),yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear(),m:t.getUTCMonth()+1,M:o[s].monthsShort[t.getUTCMonth()],MM:o[s].months[t.getUTCMonth()],d:t.getUTCDate(),D:o[s].daysShort[t.getUTCDay()],DD:o[s].days[t.getUTCDay()],p:o[s].meridiem.length==2?o[s].meridiem[t.getUTCHours()<12?0:1]:"",h:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds(),z:r},l.H=o[s].meridiem.length==2?l.h%12==0?12:l.h%12:l.h,l.HH=(l.H<10?"0":"")+l.H,l.P=l.p.toUpperCase(),l.Z=l.z,l.hh=(l.h<10?"0":"")+l.h,l.ii=(l.i<10?"0":"")+l.i,l.ss=(l.s<10?"0":"")+l.s,l.dd=(l.d<10?"0":"")+l.d,l.mm=(l.m<10?"0":"")+l.m;else{if("php"!=n)throw new Error("Invalid format type.");l={y:t.getUTCFullYear().toString().substring(2),Y:t.getUTCFullYear(),F:o[s].months[t.getUTCMonth()],M:o[s].monthsShort[t.getUTCMonth()],n:t.getUTCMonth()+1,t:a.getDaysInMonth(t.getUTCFullYear(),t.getUTCMonth()),j:t.getUTCDate(),l:o[s].days[t.getUTCDay()],D:o[s].daysShort[t.getUTCDay()],w:t.getUTCDay(),N:t.getUTCDay()==0?7:t.getUTCDay(),S:t.getUTCDate()%10<=o[s].suffix.length?o[s].suffix[t.getUTCDate()%10-1]:"",a:o[s].meridiem.length==2?o[s].meridiem[t.getUTCHours()<12?0:1]:"",g:t.getUTCHours()%12==0?12:t.getUTCHours()%12,G:t.getUTCHours(),i:t.getUTCMinutes(),s:t.getUTCSeconds()},l.m=(l.n<10?"0":"")+l.n,l.d=(l.j<10?"0":"")+l.j,l.A=l.a.toString().toUpperCase(),l.h=(l.g<10?"0":"")+l.g,l.H=(l.G<10?"0":"")+l.G,l.i=(l.i<10?"0":"")+l.i,l.s=(l.s<10?"0":"")+l.s
}for(var t=[],c=e.extend([],i.separators),d=0,h=i.parts.length;h>d;d++)c.length&&t.push(c.shift()),t.push(l[i.parts[d]]);return c.length&&t.push(c.shift()),t.join("")},convertViewMode:function(e){switch(e){case 4:case"decade":e=4;break;case 3:case"year":e=3;break;case 2:case"month":e=2;break;case 1:case"day":e=1;break;case 0:case"hour":e=0}return e},headTemplate:'<thead><tr><th class="prev"><i class="{iconType} {leftArrow}"/></th><th colspan="5" class="switch"></th><th class="next"><i class="{iconType} {rightArrow}"/></th></tr></thead>',headTemplateV3:'<thead><tr><th class="prev"><span class="{iconType} {leftArrow}"></span> </th><th colspan="5" class="switch"></th><th class="next"><span class="{iconType} {rightArrow}"></span> </th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};a.template='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-hours">'+'<table class=" table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-days">'+'<table class=" table-condensed">'+a.headTemplate+"<tbody></tbody>"+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-months">'+'<table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-years">'+'<table class="table-condensed">'+a.headTemplate+a.contTemplate+a.footTemplate+"</table>"+"</div>"+"</div>",a.templateV3='<div class="datetimepicker"><div class="datetimepicker-minutes"><table class=" table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-hours">'+'<table class=" table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-days">'+'<table class=" table-condensed">'+a.headTemplateV3+"<tbody></tbody>"+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-months">'+'<table class="table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+"</table>"+"</div>"+'<div class="datetimepicker-years">'+'<table class="table-condensed">'+a.headTemplateV3+a.contTemplate+a.footTemplate+"</table>"+"</div>"+"</div>",e.fn.datetimepicker.DPGlobal=a,e.fn.datetimepicker.noConflict=function(){return e.fn.datetimepicker=n,this},e(document).on("focus.datetimepicker.data-api click.datetimepicker.data-api",'[data-provide="datetimepicker"]',function(t){var i=e(this);i.data("datetimepicker")||(t.preventDefault(),i.datetimepicker("show"))}),e(function(){e('[data-provide="datetimepicker-inline"]').datetimepicker()})}),function(e){e.fn.datetimepicker.dates["zh-CN"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",suffix:[],meridiem:["",""]}}(jQuery),function(e){e.fn.datetimepicker.dates["zh-TW"]={days:["","","","","","","",""],daysShort:["","","","","","","",""],daysMin:["","","","","","","",""],months:["","","","","","","","","","","",""],monthsShort:["","","","","","","","","","","",""],today:"",suffix:[],meridiem:["",""]}}(jQuery),function(){$(function(){var e,t,i,s,n,o,a,r,l,c,d,h,u,p,f,m,g;m=5,this.title_fork_url="",f="",this.title_project_path="",this.title_post_url="",this.title_p_name="",this.title_p_id="",this.title_description="",this.title_form_authenticity_token="",p=null,e=$("#btn-fetch-code").popup({position:"right center"}),t=$("#btn-sync-from-github").popup({position:"right center"}),s=$("#modal-sync-from-github"),n=$("#modal-sync-from-origin"),r=$(".git-project-title"),o=$(".new-line-labels"),$("#project-language").popup({position:"right center"}),r.find(".license.label").popup({position:"right center"}),r.children(".iconfont").popup({position:"right center"}),r.find(".project-title .iconfont").popup({position:"right center"}),o.find(".label").popup({position:"right center"}),a=r.find(".git-project-recommend-badge"),i=r.find(".git-project-gvp-badge"),a.length>0&&a.popup({position:"right center",content:a.attr("title")}),i.length>0&&i.popup({position:"right center",content:i.attr("title")});try{$(".author").length===1?(c=$.trim($(".author").attr("href"))+"/"+title_project_path+"/check_fetch",g=$.trim($(".repository").attr("href"))+"/force_sync_project"):$(".author").length>1&&(c=$.trim($(".author").eq(0).attr("href"))+"/"+title_project_path+"/check_fetch",g=$.trim($(".repository").eq(0).attr("href"))+"/force_sync_project")}catch(v){return h=v,void 0}return d=function(i,s,n){var o,a;return null==s&&(s=!0),null==n&&(n=""),s?(gon.wait_fetch=!0,o=t.find("i"),o=i===this.title_import_url||i===g?t.find("i"):e,o.removeClass("refresh").addClass("loading spinner"),e.attr("title","..."),e.popup({position:"right center"}),f=setInterval(l,5e3),void 0):(a=void 0,a=i===this.title_import_url||i===g?$(".remote-message .popup > .content"):$(".fork-message .popup > .content"),void 0!==n&&""!==n?a.text(n):a.text(",,"),void 0)},l=function(){return $.ajax({type:"GET",url:c,dataType:"json",success:function(e){return e.in_fetch?void 0:(clearInterval(f),e.empty_repo?($("#fetch-error .error_msg").html(e.error_msg),$("#fetch-error").fadeIn()):$("#fetch-ok").fadeIn(),location.reload(!0))}})},u=function(){var e,i,n,o;return e=t.find("i"),o=s.find("input[name=user_sync_code]").val(),i=s.find("input[name=password_sync_code]").val(),n=s.find(".sync-wiki input").prop("checked"),$.ajax({type:"POST",url:g,timeout:12e4,dataType:"json",data:{user_sync_code:o,password_sync_code:i,sync_wiki:n,authenticity_token:title_form_authenticity_token},beforeSend:function(){return e.css("color",""),e.addClass("loading spinner").removeClass("refresh")},success:function(t){return t.status===0?(t.message!==void 0&&t.message!==""&&($("#import-result-message .status-message").text(t.message),$("#import-result-message").fadeIn(),setTimeout(function(){return $("#import-result-message").fadeOut()},2e3)),d(title_import_url,!1,t.message),e.removeClass("loading spinner").addClass("refresh")):(d(title_import_url),$("#new_file_bread").on("click",function(e){return e.preventDefault(),alert(","),!1}))}})},$("#write-cloneurl-message button").click(function(){var e,t;return e=$("#write-cloneurl-message #import_url").val(),t=$("#write-cloneurl-message span.message"),e.indexOf("http")===-1?(t.html(" * http/httpsclone"),void 0):e.indexOf(title_project_path)===-1?(t.html(" * clone"),void 0):($("#write-cloneurl-message i.refresh").show(),$.post(post_url,{import_url:e},function(){var i;return t.html("."),i=e,$("#write-cloneurl-message").hide(),s.modal("show")}))}),t.on("click",function(){if(gon.wait_fetch===void 0||gon.wait_fetch!==!0){if("false"===import_url)return $("#write-cloneurl-message").show(),void 0;if(n.modal("hide"),s.modal("show"),!p)return checkProjectPrivate(title_import_url,function(e){return e?(p="private",s.find(".authen-info").removeClass("hide")):p="public",s.find(".ok.button").removeClass("disabled"),s.modal("refresh")})}}),s.modal({onApprove:u}),e.click(function(){(gon.wait_fetch===void 0||gon.wait_fetch!==!0)&&(s.modal("hide"),n.modal("show"))}),n.find(".button.ok").on("click",function(){$.ajax({type:"POST",url:title_fork_url,dataType:"json",data:{fetch_code:1},beforeSend:function(){return e.css("color",""),n.modal("hide"),e.addClass("loading spinner").removeClass("refresh")},success:function(t){return t.status===0?(t.message!==void 0&&t.message!==""&&($("#import-result-message .status-title").text(""),$("#import-result-message .status-message").text(t.message),$("#import-result-message").fadeIn(),setTimeout(function(){return $("#import-result-message").fadeOut()},2e3)),d(title_fork_url,!1,t.message),e.removeClass("loading spinner").addClass("refresh")):d(title_fork_url)}})}),gon.fetch_url!==void 0?d(gon.fetch_url):void 0})}.call(this),$(function(){$("select.chosen").chosen(),$(".project-refs-form .group-result").each(function(e){if(0==e){var t=0;$(this).nextAll().each(function(){return $(this).hasClass("group-option")?(t+=1,void 0):!1});var i="/"+gon.user_project+"/branches/recent",s=$(this).text();$(this).text(s+"("+t+")"),$(this).append("<a href='#' style='float:right;' onclick='javascript:window.location.href=\""+i+"\"'>"+gon.manage_branch+"</a>")}else if(1==e){var n=$(this).next(),t=0;if(n.text()==""){n.css("display","none");var t=-1}$(this).nextAll().each(function(){return $(this).hasClass("group-option")?(t+=1,void 0):!1});var o="/"+gon.user_project+"/tags",s=$(this).text();$(this).text(s+"("+t+")"),$(this).append("<a href='#' style='float:right;' onclick='javascript:window.location.href=\""+o+"\"'>"+gon.manage_tag+"</a>")}}),$(".project-refs-select").trigger("chosen:updated")});